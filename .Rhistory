label_x = c(-0.02, 0),# Adjust the position of the labels (A, B)
rel_widths = c(0.9, 1.1), # Panel A is 90% of its size and Panel B is 110%
align = "h",  # Aligns panels vertically
axis = "b"# Aligns both top and bottom axes
)
upper_row
dev.off()
#empirical
output_ind_ES_emp <- read.csv("Data/Land_use_output_weighted_CP_intense.csv", sep =",")
output_ind_ES_emp$management <- factor(output_ind_ES_emp$management, levels = c("E", "SE", "M", "SI","I","IM")) #change order of factors
#Empirical
Prop_indir_Emp<-output_ind_ES_emp  %>%
group_by(management,services_to) %>%
mutate(tot = n()) %>% ungroup() %>%
group_by(services_to) %>%
mutate(prop = tot/max(tot)) %>%  #prop of indirect effects on E(D)S retained in the empirical
dplyr::select(management,services_to,tot,prop) %>%
unique() %>% rename("Prop_mean" = "prop") %>%
mutate (type = "Empirical")
# adjust the extreme values according to the beta conditions
Prop_indir_Emp$Prop_mean <- ifelse(Prop_indir_Emp$Prop_mean == 0, 0.000001,
ifelse(Prop_indir_Emp$Prop_mean == 1, 0.9999999, Prop_indir_Emp$Prop_mean))
#Simulations
output_ind_ES<- read.csv("Data/Indirect_ES_sim_CP.csv", sep =",") %>% filter(services_to !="None")
output_ind_ES$management <- factor(output_ind_ES$management, levels = c("E", "SE", "M", "SI","I","IM")) #change order of factors
Prop_ind_null<-output_ind_ES %>% filter(!(iteration == "Emp" & management =="E")) %>%
group_by(management,iteration,services_to) %>%
mutate(tot = n(),
tot_emp = case_when( #Values of denominator
services_to == "Crop production"~ 1129,
services_to == "Pollination" ~ 18733,
services_to == "Crop damage"~ 9992,
services_to == "Pest control"~ 3272,
services_to == "Seed dispersal" ~ 4224,
services_to == "Butterfly watching"~ 3515,
services_to == "Bird watching"~ 5820 )) %>% ungroup() %>%
group_by(services_to) %>%
mutate(Prop_mean = tot/tot_emp) %>%  #prop of E(D)S rtained across habitat management per iteration and habitat management
dplyr::select(management,iteration,services_to,Prop_mean) %>%
unique() %>% mutate(type = "Null")
# adjust the extreme values according to the beta conditions
Prop_ind_null$Prop_mean <- ifelse(Prop_ind_null$Prop_mean == 0, 0.000001,
ifelse(Prop_ind_null$Prop_mean == 1, 0.9999999, Prop_ind_null$Prop_mean))
Prop_indir_sim<- Prop_ind_null %>% group_by(management,services_to) %>%
summarise(Prop_mean = mean(Prop_mean)) %>%
mutate(type = "Null")
# Merge empirical and simulations and remove extensive scenario
Prop_indir_sim2 <- rbind(Prop_indir_Emp, Prop_indir_sim)
Prop_indir_sim2$management <- factor(Prop_indir_sim2$management, levels = c("E", "SE", "M", "SI","I","IM")) #change order of factors
color_services <-tibble(
services = unique(Prop_indir_sim2$services_to),
color = c('#1b9e77','#d95f02','#7570b3','#e7298a','#2c7fb8','#e6ab02','#a6761d'))
prop_EDS_indirect <- Prop_indir_sim2%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8, position = position_dodge(width = 1.02))  +
geom_point(aes(fill = factor(services_to), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Prop. of indirect effects on E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Habitat conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
prop_EDS_indirect
prop_EDS_indirect <- Prop_indir_sim2%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8, position = position_dodge(width = 1.02))  +
geom_point(aes(fill = factor(services_to), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "ES") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Prop. of indirect effects on ES retained", limits = c(0, 1)) +
scale_x_discrete(name = "land conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
prop_EDS_indirect
prop_EDS_indirect <- Prop_indir_sim2%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8, position = position_dodge(width = 1.02))  +
geom_point(aes(fill = factor(services_to), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "ES") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Prop. of indirect effects on ES retained", limits = c(0, 1)) +
scale_x_discrete(name = "Land conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
prop_EDS_indirect
ggsave("Graphs/Indirect_ES_sim_CP.png", width = 7, height = 5, dpi = 300)
color_services <-tibble(
services = unique(Prop_indir_sim2$services_to),
color = c('#1b9e77','#d95f02','#7570b3','#e7298a','#2c7fb8','#e6ab02','#a6761d'))
prop_EDS_indirect <- Prop_indir_sim2%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8, position = position_dodge(width = 1.02))  +
geom_point(aes(fill = factor(services_to), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "ES") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Prop. of indirect effects on ES retained", limits = c(0, 1)) +
scale_x_discrete(name = "Land conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
prop_EDS_indirect
ggsave("Graphs/Indirect_ES_sim_CP.png", width = 7, height = 5, dpi = 300)
pdf("Graphs/Indirect_ES_sim_CP.pdf", width = 7, height = 5)
prop_EDS_indirect
dev.off()
#upload and prepare dataframe
direct_ES<- read.csv("Data/direct_ES_sim_CP.csv", sep =",")
direct_ES$management <- factor(direct_ES$management, levels = c("E", "SE", "M", "SI","I","IM")) #change order of factors
### Plot of proportions of richness direct and indirect E(D)S retained
color_services <-tibble(
services = unique(direct_ES$services),
color = c('#1b9e77','#d95f02','#7570b3','#e7298a','#2c7fb8','#e6ab02','#a6761d'))
#Empirical
Prop_dir_emp<-direct_ES %>% filter(iteration == "Emp") %>% group_by(management,services) %>%
mutate(tot = n()) %>% ungroup() %>%
group_by(services) %>%
mutate(prop = tot/max(tot)) %>%  #prop of E(D)S rtained across habitat management
dplyr::select(management,services,tot,prop) %>%
unique() %>% rename("Prop_mean" = "prop") %>% mutate(type = "Emp")
# Value of empirical
values_emp<- Prop_dir_emp %>% filter (management == "E") %>% select(management,tot)
#Simulations
Prop_dir_sim<-direct_ES %>% filter(iteration != "Emp") %>% group_by(management,iteration,services) %>%
mutate(tot = n(),
tot_emp = case_when( #Values of denominator
services == "Crop production"~ 6,
services == "Pollination" ~ 117,
services == "Crop damage"~ 15,
services == "Pest control"~ 28,
services == "Seed dispersal" ~ 5,
services == "Butterfly watching"~ 16,
services == "Bird watching"~ 7 )) %>% ungroup() %>%
group_by(services) %>%
mutate(prop = tot/tot_emp) %>%  #prop of E(D)S rtained across habitat management per iteration and habitat management
dplyr::select(management,iteration,services,tot,prop) %>%
unique() %>% group_by(management,services) %>% summarise(Prop_mean = mean(prop)) %>%
mutate(type = "Null")
#join
Prop_direct_sim<-rbind(Prop_dir_emp,Prop_dir_sim)
#Plot
prop_EDS_direct <- Prop_direct_sim%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8, position = position_dodge(width = 1.02)) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 1.2, dodge.width = 0.5),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Prop. of direct E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Habitat conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
#join
Prop_direct_sim<-rbind(Prop_dir_emp,Prop_dir_sim)
pdf("Graphs/Direct_ES_sim_CP.pdf", width = 7, height = 5)
prop_EDS_direct <- Prop_direct_sim%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8, position = position_dodge(width = 1.02)) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 1.2, dodge.width = 0.5),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "ES") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Prop. of direct ES retained", limits = c(0, 1)) +
scale_x_discrete(name = "Habitat conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
prop_EDS_direct
dev.off()
### Calculate ratio of change for empirical
direct_ES_emp<- read.csv("Data/Land_use_dir_weighted_CP_intense.csv", sep =",") #upload empirical
#amount Bird and butterfly watching
tot_services_emp_watching<-direct_ES_emp %>% filter(management=="E" &  (services == "Bird watching" | services == "Butterfly watching" )) %>%
group_by(management,services) %>%
summarize(tot_empirical_amount = sum(abun))
Prop_weight_watching<-  direct_ES_emp %>% group_by(management,services) %>%
filter (services == "Bird watching" | services == "Butterfly watching") %>%
summarize(tot= sum(abun))%>% ungroup() %>%
mutate(Extensive_tot = case_when(
services == "Bird watching"~ 2076,
services == "Butterfly watching"~ 6903),
ratio_change = tot / Extensive_tot)
#amount the rest ESs
tot_services_emp_rest<-direct_ES_emp %>% filter(management=="E" &  !(services == "Bird watching" | services == "Butterfly watching" )) %>%
group_by(management,services) %>%
summarize(tot_empirical_amount = sum(weight))
Prop_weight_rest<-  direct_ES_emp %>% group_by(management,services) %>%
filter (!(services == "Bird watching" | services == "Butterfly watching")) %>%
summarize(tot= sum(weight))%>% ungroup() %>%
mutate(Extensive_tot = case_when(
services == "Crop damage"~ 711450.9469,
services == "Crop production"~ 209300.0000,
services == "Pest control"~ 7108.3167,
services == "Pollination"~ 36736.7426,
services == "Seed dispersal"~ 362197.4900),
ratio_change = tot / Extensive_tot)
#merge the data
Prop_amount<- rbind(Prop_weight_watching,Prop_weight_rest)
### Calculate ratio of change for simulations
direct_ES_sim<- read.csv("Data/direct_ES_sim_CP.csv", sep =",")
## Amount Bird and butterfly watching
dir_amount_watching_sim <- direct_ES_sim %>% filter (management !="E") %>%
filter(services == "Bird watching" | services == "Butterfly watching" ) %>%
group_by(management,iteration,services) %>%
summarize(tot_sim_amount = sum(abun)) %>%
left_join(Prop_amount, by = c("management", "services"), suffix = c("", "_extensive")) %>%
select(-ratio_change)  %>%
mutate(ratio_change = tot_sim_amount / Extensive_tot) %>% #ratio of change: values higher than 1 indicates increasing in the amount of E(D)S
select(management,services,ratio_change) %>%
group_by(management,services) %>%
summarise(ratio_change_ave = mean(ratio_change)) %>%
mutate(type = "Null")
## Amount of the rest Es
dir_amount_rest_sim <- direct_ES_sim %>% filter (management !="E") %>%
filter(!(services == "Bird watching" | services == "Butterfly watching" )) %>%
group_by(management,iteration,services) %>%
summarize(tot_sim_amount= sum(weight)) %>%
left_join(Prop_amount, by = c("management", "services"), suffix = c("", "_extensive")) %>%
select(-ratio_change)  %>%
mutate(ratio_change = tot_sim_amount / Extensive_tot) %>% #ratio of change: values higher than 1 indicates increasing in the amount of E(D)S
select(management,services,ratio_change) %>%
group_by(management,services) %>%
summarise(ratio_change_ave = mean(ratio_change)) %>%
mutate(type = "Null")
#merge the data
Prop_amount_sim<- rbind(dir_amount_watching_sim,dir_amount_rest_sim)
### Final dataframe
Prop_amount_emp<- Prop_amount %>% mutate(type = "Empirical") %>% select(-tot,-Extensive_tot) %>%  rename(ratio_change_ave = ratio_change)
ratio_amount<-rbind(Prop_amount_emp,Prop_amount_sim)
ratio_amount$management <- factor(ratio_amount$management, levels = c("E", "SE", "M", "SI","I","IM")) #change order of factors
#Plot
pdf("Graphs/amount_change_sim_CP.pdf", width = 7, height = 5)
prop_EDS_ratio <- ratio_amount%>% ggplot(aes(x = management, y = ratio_change_ave)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8,  position = position_dodge(width = 1.02)) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "ES") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Relative change in the amount \n of direct ES provided", limits = c(0, 3)) +
scale_x_discrete(name = "Land conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
dev.off()
#Plot
pdf("Graphs/amount_change_sim_CP.pdf", width = 7, height = 5)
prop_EDS_ratio <- ratio_amount%>% ggplot(aes(x = management, y = ratio_change_ave)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8,  position = position_dodge(width = 1.02)) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "ES") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Relative change in the amount \n of direct ES provided", limits = c(0, 3)) +
scale_x_discrete(name = "Land conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
dev.off()
prop_EDS_ratio <- ratio_amount%>% ggplot(aes(x = management, y = ratio_change_ave)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8,  position = position_dodge(width = 1.02)) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "ES") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Relative change in the amount \n of direct ES provided", limits = c(0, 3)) +
scale_x_discrete(name = "Land conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
prop_EDS_ratio
#Plot
pdf("Graphs/amount_change_sim_CP.pdf", width = 7, height = 5)
prop_EDS_ratio <- ratio_amount%>% ggplot(aes(x = management, y = ratio_change_ave)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8,  position = position_dodge(width = 1.02)) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "ES") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Relative change in the amount \n of direct ES provided", limits = c(0, 3)) +
scale_x_discrete(name = "Land conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
dev.off()
prop_EDS_ratio
dev.off()
#Plot
pdf("Graphs/amount_change_sim_CP.pdf", width = 7, height = 5)
prop_EDS_ratio <- ratio_amount%>% ggplot(aes(x = management, y = ratio_change_ave)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8,  position = position_dodge(width = 1.02)) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "ES") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Relative change in the amount \n of direct ES provided", limits = c(0, 3)) +
scale_x_discrete(name = "Land conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
prop_EDS_ratio
dev.off()
prop_EDS_ratio <- ratio_amount%>% ggplot(aes(x = management, y = ratio_change_ave)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8,  position = position_dodge(width = 1.02)) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "ES") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Relative change in the amount \n of direct ES provided", limits = c(0, 3)) +
scale_x_discrete(name = "Land conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
prop_EDS_ratio
dev.off()
#Plot
pdf("Graphs/amount_change_sim_CP.pdf", width = 7, height = 5)
prop_EDS_ratio <- ratio_amount%>% ggplot(aes(x = management, y = ratio_change_ave)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 0.8,  position = position_dodge(width = 1.02)) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2.4, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "ES") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Relative change in the amount \n of direct ES provided", limits = c(0, 3)) +
scale_x_discrete(name = "Land conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 14, color = "black"),
legend.text = element_text(size = 12))
prop_EDS_ratio
dev.off()
