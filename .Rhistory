pollimetry_dataset$Weight<-as.numeric(pollimetry_dataset$Weight) #repository of bees
bees_list_repo<-pollimetry_dataset  %>%  select(Region,Country,Species,Weight) %>%
filter(Region == "Europe" & !(is.na(Weight))) %>% mutate(Species = gsub("_", " ", Species),
Weight = Weight / 1000) #to gr
View(bees_list_repo)
pollimetry_dataset$Weight<-as.numeric(pollimetry_dataset$Weight) #repository of bees
bees_list_repo<-pollimetry_dataset  %>%  select(Region,Country,Species,Weight) %>%
filter(Region == "Europe" & !(is.na(Weight))) %>% mutate(Species = gsub("_", " ", Species),
Weight = Weight / 1000) %>% #to gr
group_by(Species) %>% mutate(biomass.g = mean (Weight)) # calculate average of Weight
View(bees.list)
View(bees_list_repo)
bees_list_repo<-pollimetry_dataset  %>%  select(Region,Country,Species,Weight) %>%
filter(Region == "Europe" & !(is.na(Weight))) %>% mutate(Species = gsub("_", " ", Species),
Weight = Weight / 1000) %>% #to gr
group_by(Species) %>% summarise(biomass.g = mean (Weight)) # calculate average of Weight
View(bees_list_repo)
poll_list_repo<-pollimetry_dataset  %>%  select(Region,Country,Species,Weight) %>%
filter(Region == "Europe" & !(is.na(Weight))) %>% mutate(Species = gsub("_", " ", Species),
Weight = Weight / 1000) %>% #to gr
group_by(Species) %>% summarise(biomass.g = mean (Weight)) # calculate average of Weight
#repository of pollinators
library(pollimetry) #package containing data of pollinators
pollimetry_dataset$Weight<-as.numeric(pollimetry_dataset$Weight) #repository of pollinators
poll_list_repo<-pollimetry_dataset  %>%  select(Region,Country,Species,Weight) %>%
filter(Region == "Europe" & !(is.na(Weight))) %>%
mutate(Species = gsub("_", " ", Species),
Weight = Weight / 1000) %>% #to gr
group_by(Species) %>% summarise(biomass.g = mean (Weight)) # calculate average of Weight
View(poll_list_repo)
mass.bees<- bees.list %>% left_join(poll_list_repo, by = c("Species","node_name"))
mass.bees<- bees.list %>% left_join(poll_list_repo, by = c("node_name","Species"))
mass.bees<- bees.list %>% left_join(poll_list_repo, by = c("Species"="node_name"))
mass.bees<- bees.list %>% left_join(poll_list_repo, by = c("node_name"="Species"))
View(mass.bees)
poll_list_repo<-pollimetry_dataset  %>%  select(Region,Country,Species,Weight) %>%
filter(!(is.na(Weight))) %>%
mutate(Species = gsub("_", " ", Species),
Weight = Weight / 1000) %>% #to gr
group_by(Species) %>% summarise(biomass.g = mean (Weight)) # calculate average of Weight
mass.bees<- bees.list %>% left_join(poll_list_repo, by = c("node_name"="Species"))
#check for those species in the repository that match in our dataframe
mass.bees<- bees.list %>% left_join(poll_list_repo, by = c("node_name"="Species")) %>%
mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g)) #do the average for the rest
View(mass.bees)
#repository of pollinators
library(pollimetry) #package containing data of pollinators
pollimetry_dataset$Weight<-as.numeric(pollimetry_dataset$Weight) #repository of pollinators
poll_list_repo<-pollimetry_dataset  %>%  select(Region,Country,Species,Weight) %>%
filter(Region == "Europe" & !(is.na(Weight))) %>%
mutate(Species = gsub("_", " ", Species),
Weight = Weight / 1000) %>% #to gr
group_by(Species) %>% summarise(biomass.g = mean (Weight)) # calculate average of Weight
## Hover flies
hov<-nore %>% filter(upper.guild == "11HO") %>% select(upper,upper.guild) %>%
unique() %>% mutate(upper = substring(upper, 7)) #list of hover flies
hov.list<-species_list %>% filter(node_name%in%hov$upper)#select hover flies from the whole species list
#check for those species in the repository that match in our dataframe
mass.hov<- hov.list %>% left_join(poll_list_repo, by = c("node_name"="Species")) %>%
mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g)) #do the average for the rest
View(mass.hov)
mass.hov<- hov.list %>% left_join(poll_list_repo, by = c("node_name"="Species"))
View(mass.hov)
mass.hov<- hov.list %>% left_join(poll_list_repo, by = c("node_name"="Species")) %>%
mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g))
mass.ot.flw<- ot.flw.list %>% left_join(poll_list_repo, by = c("node_name"="Species"))
View(mass.ot.flw)
View(mass.ot.flw)
mass.ot.flw<- mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
mass.ot.flw<- mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Apanteles circumscriptus" ~ 0.0089,
node_name == "Anagrus sp A" ~ 0.0000288,
node_name == "Anagrus sp B" ~ 0.0000288,
node_name == "Anagrus sp C" ~ 0.0000288,
node_name == "Asaphes suspensus"~ 0.00000927,
node_name == "Chelonus sp"~ 0.0069,
node_name == "Chelonus sp aff rimatus"~ 0.0069,
node_name == "Chelonus scabrosus"~ 0.0069,
node_name == "Diadegma crataegi"~ 0.000674))
View(mass.ot.flw)
mass.ot.flw<- mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Apanteles circumscriptus" ~ 0.0089,
node_name == "Anagrus sp A" ~ 0.0000288,
node_name == "Anagrus sp B" ~ 0.0000288,
node_name == "Anagrus sp C" ~ 0.0000288,
node_name == "Asaphes suspensus"~ 0.00000927,
node_name == "Chelonus sp"~ 0.0069,
node_name == "Chelonus sp aff rimatus"~ 0.0069,
node_name == "Chelonus scabrosus"~ 0.0069,
node_name == "Diadegma crataegi"~ 0.000674)
)
mass.ot.flw<- ot.flw.list %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Apanteles circumscriptus" ~ 0.0089,
node_name == "Anagrus sp A" ~ 0.0000288,
node_name == "Anagrus sp B" ~ 0.0000288,
node_name == "Anagrus sp C" ~ 0.0000288,
node_name == "Asaphes suspensus"~ 0.00000927,
node_name == "Chelonus sp"~ 0.0069,
node_name == "Chelonus sp aff rimatus"~ 0.0069,
node_name == "Chelonus scabrosus"~ 0.0069,
node_name == "Diadegma crataegi"~ 0.000674)
)
mass.ot.flw<- ot.flw.list %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Bruchidius varius"~ 0.003,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Rhinocyllus conicus"~ 0.00845,
node_name == "Sitona lineatus"~ 0.00165,
node_name == "Urophora stylata"~ 0.0041)
)
View(mass.ot.flw)
check<-mass.ot.flw %>% filter(!is.na(biomass.g))
View(check)
mass.ot.flw<- ot.flw.list %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Pteromalus albipennis"~ 0.0013,
node_name == "Mesopolobus incultus"~ 0.00045,
node_name == "Pteromalus elevatus"~ 0.0121,
node_name == "Bracon immutator"~ 0.0025,
node_name == "Bracon osculator"~ 0.0025,
node_name == "Bracon praecox"~ 0.0025))
check<-mass.ot.flw %>% filter(!is.na(biomass.g))
mass.ot.flw<- ot.flw.list %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Acyrthosiphon pisum"~ 0.0008623,
node_name == "Myzus persicae"~ 0.0002042,
node_name == "Sitobion avenae"~ 0.0031632))
check<-mass.ot.flw %>% filter(!is.na(biomass.g))
mass.ot.flw<- ot.flw.list %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Pteromalus albipennis"~ 0.0013,
node_name == "Mesopolobus incultus"~ 0.00045,
node_name == "Pteromalus elevatus"~ 0.0121,
node_name == "Bracon immutator"~ 0.0025,
node_name == "Bracon osculator"~ 0.0025,
node_name == "Bracon praecox"~ 0.0025))
check<-mass.ot.flw %>% filter(!is.na(biomass.g))
View(check)
mass.ot.flw<- ot.flw.list %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Pteromalus albipennis"~ 0.0013,
node_name == "Mesopolobus incultus"~ 0.00045,
node_name == "Pteromalus elevatus"~ 0.0121,
node_name == "Bracon immutator"~ 0.0025,
node_name == "Bracon osculator"~ 0.0025,
node_name == "Bracon praecox"~ 0.0025,
node_name == "Asaphes suspensus "~ 0.00000927))
check<-mass.ot.flw %>% filter(!is.na(biomass.g))
mass.ot.flw<- ot.flw.list %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Pteromalus albipennis"~ 0.0013,
node_name == "Mesopolobus incultus"~ 0.00045,
node_name == "Pteromalus elevatus"~ 0.0121,
node_name == "Bracon immutator"~ 0.0025,
node_name == "Bracon osculator"~ 0.0025,
node_name == "Bracon praecox"~ 0.0025,
node_name == "Asaphes suspensus "~ 0.00000927,
node_name == "Acyrthosiphon pisum"~ 0.0008623,
node_name == "Myzus persicae"~ 0.0002042,
node_name == "Sitobion avenae"~ 0.0031632))
check<-mass.ot.flw %>% filter(!is.na(biomass.g))
mass.ot.flw<- ot.flw.list %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Pteromalus albipennis"~ 0.0013,
node_name == "Mesopolobus incultus"~ 0.00045,
node_name == "Pteromalus elevatus"~ 0.0121,
node_name == "Bracon immutator"~ 0.0025,
node_name == "Bracon osculator"~ 0.0025,
node_name == "Bracon praecox"~ 0.0025,
node_name == "Asaphes suspensus "~ 0.00000927,
node_name == "Acyrthosiphon pisum"~ 0.0008623,
node_name == "Aphidius rhopalosiphi"~ 0.000161,
node_name == "Aphidius matricariae"~ 0.00088))
check<-mass.ot.flw %>% filter(!is.na(biomass.g))
repo_1<-read_excel("coleoptera.xlsx", sheet = 2)
repo_1<-read_excel("Data/biomass_repositories/coleoptera.xlsx", sheet = 2)
View(repo_1)
repo_1<-read_excel("Data/biomass_repositories/coleoptera.xlsx", sheet = 3) %>% select(Species,Mass(mg)) %>%
mutate(biomass.g = Mass(mg)/1000)
repo_1<-read_excel("Data/biomass_repositories/coleoptera.xlsx", sheet = 3) %>% select(Species,Mass (mg)) %>%
mutate(biomass.g = Mass (mg)/1000)
repo_1<-read_excel("Data/biomass_repositories/coleoptera.xlsx", sheet = 3) %>% select(Species, Mass (mg))
repo_1_clean<-repo_1%>% select(Species, Mass (mg)) %>%
mutate(biomass.g = Mass (mg)/1000)
#manually
mass.ot.flw<- ot.flw.list %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Olibrus aeneus"~ 0.000251))
View(repo_1)
repo_1<-read_excel("Data/biomass_repositories/coleoptera.xlsx", sheet = 3)
repo_1_clean<-repo_1%>% select(Species, Mass (mg)) %>%
mutate(biomass.g = Mass (mg)/1000)
repo_1_clean<-repo_1%>% select(Species, Mass(mg))
repo_1_clean<-repo_1%>% select(Species, Mean Mass (mg)) %>%
mutate(biomass.g = Mean Mass (mg)/1000) #convert to g
repo_1_clean<-repo_1%>% select(Species, "Mean Mass (mg)") %>%
mutate(biomass.g = Mean Mass (mg)/1000) #convert to g
repo_1_clean<-repo_1%>% select(Species, "Mean Mass (mg)") %>%
mutate(biomass.g = "Mean Mass (mg)"/1000) #convert to g
repo_1_clean<-repo_1%>% select(Species, "Mean Mass (mg)")
repo_1_clean<-repo_1%>% select(Species, Mean Mass (mg))
repo_1_clean<-repo_1%>% select(Species, 'Mean Mass (mg)') %>%
mutate(biomass.g = 'Mean Mass (mg)'/1000) #convert to g
repo_1_clean<-repo_1%>% select(Species, 'Mean Mass (mg)')
repo_1<-read_excel("Data/biomass_repositories/coleoptera.xlsx", sheet = 3)
repo_1_clean<-repo_1%>% select(Species, 'Mean mass (mg)') %>%
mutate(biomass.g = 'Mean mass (mg)'/1000) #convert to g
repo_1_clean<-repo_1%>% select(Species, 'Mean mass (mg)')
View(repo_1_clean)
repo_1_clean<-repo_1%>% select(Species, 'Mean mass (mg)') %>%
mutate(biomass.g = 'Mean mass (mg)'/1000) #convert to g
repo_1<-read_excel("Data/biomass_repositories/coleoptera.xlsx", sheet = 3)
repo_1_clean<-repo_1%>% select(Species, 'Mean mass (mg)')
repo_1_clean$`Mean mass (mg)`<-as.numeric(repo_1_clean$`Mean mass (mg)`)
repo_1_final<-repo_1_clean %>%
mutate(biomass.g = 'Mean mass (mg)'/1000) #convert to g
repo_1_clean$`Mean mass (mg)`<-as.numeric(repo_1_clean$`Mean mass (mg)`)
repo_1_final<-repo_1_clean %>%
mutate(biomass.g = 'Mean mass (mg)'/1000) #convert to g
repo_1_final<-repo_1_clean %>%
mutate(biomass.g = Mean mass (mg)/1000) #convert to g
repo_1_final<-repo_1_clean %>%
mutate(biomass.g = `Mean mass (mg)`/1000) #convert to g
View(repo_1_final)
#check for those species in the repository that match in our dataframe
mass.ot.flw<- ot.flw.list %>% left_join(repo_1_final, by = c("node_name"="biomass.g"))
View(ot.flw.list)
#check for those species in the repository that match in our dataframe
mass.ot.flw<- ot.flw.list %>% left_join(repo_1_final, by = c("node_name"="Species"))
View(mass.ot.flw)
View(mass.ot.flw)
full_list<-rbind(mass.leaf.min.par,mass.seed.ins,mass.ins.par,mass.2.par,mass.1.par,
mass.aphid,mass.hov)
aphid.par.repo<-read.delim("Data/biomass_repositories/bodysizes_2008.txt")
filter_sps<-aphid.par.repo %>% filter(Taxonomy.consumer%in%species_list$node_name |
Taxonomy.resource%in%species_list$node_name) %>%
select(Taxonomy.consumer,Mean.mass..g..consumer,Taxonomy.resource,
Mean.mass..g..resource) %>%  #filter sps from the database
unique() #the biomass is already averaged
#Split consumer and resource information
upper<- filter_sps[,1:2] %>% rename("node_name" = "Taxonomy.consumer", "biomass.g" ="Mean.mass..g..consumer")
lower<-filter_sps[,3:4] %>% rename("node_name" = "Taxonomy.resource", "biomass.g" ="Mean.mass..g..resource")
#function to keep the first two words in species name from the repository
keep_first_two_words <- function(text) {
words <- str_split(text, "\\s+")[[1]]
paste(words[1:2], collapse = " ")
}
#apply function
aphid.par.bio<-rbind(upper,lower) %>% unique() %>%
filter(biomass.g >0) %>% #eliminate species with - biomass (error in dataframe)
mutate( node_name = sapply(node_name, keep_first_two_words)) %>%
mutate(node_name = gsub("\\bNA\\b", "", node_name)) #eliminate extra text in some columns
#add data of biomass manually and do the average for the rest
mass.aphid<- species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>%  mutate (biomass.g = case_when(node_name == "Acyrthosiphon pisum"~ 0.0008623,
node_name == "Myzus persicae"~ 0.0002042,
node_name == "Sitobion avenae"~ 0.0031632,
TRUE~biomass.g)) %>%
filter(taxon == "Aphid")# %>% mutate(biomass.g =if_else(is.na(biomass.g),
View(mass.aphid)
#add data of biomass manually and do the average for the rest
mass.1.par<-species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>% filter(taxon == "Primary aphid parasitoid") %>%
mutate (biomass.g = case_when(node_name == "Aphidius rhopalosiphi"~ 0.000161,
node_name == "Aphidius matricariae"~ 0.00088,
TRUE~biomass.g)) #%>% #add manually more data
mass.2.par<-species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>% filter(taxon == "Secondary aphid parasitoid")%>%
mutate (biomass.g = case_when(node_name == "Asaphes suspensus "~ 0.00000927,
TRUE~biomass.g)) #%>% #add the data manually
## Insect seed feeder parasitoid
mass.ins.par<-species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>% filter(taxon == "Insect seed-feeder parasitoid") %>%
mutate (biomass.g = case_when(node_name == "Pteromalus albipennis"~ 0.0013,
node_name == "Mesopolobus incultus"~ 0.00045,
node_name == "Pteromalus elevatus"~ 0.0121,
node_name == "Bracon immutator"~ 0.0025,
node_name == "Bracon osculator"~ 0.0025,
node_name == "Bracon praecox"~ 0.0025,
TRUE~biomass.g)) #%>% #add manually more data
mass.seed.ins<-species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>% filter(taxon == "Seed-feeding insect")  %>%
mutate (biomass.g = case_when(node_name == "Bruchidius varius"~ 0.003,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Rhinocyllus conicus"~ 0.00845,
node_name == "Sitona lineatus"~ 0.00165,
node_name == "Urophora stylata"~ 0.0041,
TRUE~biomass.g)) #%>% #add manually more data
## Leaf miners (do the average of all the parastioids (do it before averaging them)
mass.leaf.min.par<-species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>% filter(taxon == "Leaf-miner parasitoid")  %>%
mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Apanteles circumscriptus" ~ 0.0089,
node_name == "Anagrus sp A" ~ 0.0000288,
node_name == "Anagrus sp B" ~ 0.0000288,
node_name == "Anagrus sp C" ~ 0.0000288,
node_name == "Asaphes suspensus"~ 0.00000927,
node_name == "Chelonus sp"~ 0.0069,
node_name == "Chelonus sp aff rimatus"~ 0.0069,
node_name == "Chelonus scabrosus"~ 0.0069,
node_name == "Diadegma crataegi"~ 0.000674,
TRUE~biomass.g)) #%>% #add manually more data
full_list<-rbind(mass.leaf.min.par,mass.seed.ins,mass.ins.par,mass.2.par,mass.1.par,
mass.aphid,mass.hov)
View(full_list)
View(repo_1_final)
View(repo_1_final)
View(full_list)
#check for those species in the repository that match in our dataframe
mass.ot.flw<- ot.flw.list %>% left_join(repo_1_final, by = c("node_name"="Species"))
#manually
mass.ot.flw2<- mass.ot.flw %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Agriotes pallidulus"~  0.01966667,
node_name == "Aprostocetus sp"~  0.00008,
node_name == "Grammoptera ruficornis"~  0.005143,
node_name == "Hemicrepidius memnonius"~  0.0327,
node_name == "Rhagonycha fulva"~ 0.0015275,
node_name == "Sitona puncticollis"~ 0.00165)) %>%
mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g)) #do the average for the rest
View(mass.ot.flw2)
#check for those species in the repository that match in our dataframe
mass.ot.flw1<- ot.flw.list %>% left_join(repo_1_final, by = c("node_name"="Species"))
#manually
mass.ot.flw<- mass.ot.flw1 %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Agriotes pallidulus"~  0.01966667,
node_name == "Aprostocetus sp"~  0.00008,
node_name == "Grammoptera ruficornis"~  0.005143,
node_name == "Hemicrepidius memnonius"~  0.0327,
node_name == "Rhagonycha fulva"~ 0.0015275,
node_name == "Sitona puncticollis"~ 0.00165)) %>%
mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g)) %>% select(-'Mean mass (mg)')#do the average for the rest
View(mass.ot.flw2)
#manually
mass.ot.flw<- mass.ot.flw1 %>% mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Agriotes pallidulus"~  0.01966667,
node_name == "Aprostocetus sp"~  0.00008,
node_name == "Grammoptera ruficornis"~  0.005143,
node_name == "Hemicrepidius memnonius"~  0.0327,
node_name == "Rhagonycha fulva"~ 0.0015275,
node_name == "Sitona puncticollis"~ 0.00165)) %>%
mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g)) %>%
select (node_id,node_name,taxon,biomass.g)#do the average for the rest
View(mass.ot.flw2)
View(mass.ot.flw)
#birds
birds.repo<-read.delim("Data/biomass_repositories/BirdFuncDat.txt") %>%
select(Scientific,BodyMass.Value) %>% rename("node_name" = "Scientific",
"Mass" = "BodyMass.Value")
#check for those species in the repository that match in our dataframe
mass.birds<- species_list %>% left_join(birds.repo, by = "node_name") %>%
filter(taxon =="Seed-feeding bird")
# mammals
mam.repo<-read.delim("Data/biomass_repositories/MamFuncDat.txt")%>%
select(Scientific,BodyMass.Value) %>% rename("node_name" = "Scientific",
"Mass" = "BodyMass.Value")
#check for those species in the repository that match in our dataframe
mass.mam<- species_list %>% left_join(mam.repo, by = "node_name") %>%
filter(taxon =="Seed-feeding rodent")
# mammals
mam.repo<-read.delim("Data/biomass_repositories/MamFuncDat.txt")%>%
select(Scientific,BodyMass.Value) %>% rename("node_name" = "Scientific",
"Mass" = "BodyMass.Value")
#check for those species in the repository that match in our dataframe
mass.mam<- species_list %>% left_join(mam.repo, by = "node_name") %>%
filter(taxon =="Seed-feeding rodent")
aphid.par.repo<-read.delim("Data/biomass_repositories/bodysizes_2008.txt")
full_list<-rbind(mass.leaf.min.par,mass.seed.ins,mass.ins.par,mass.2.par,mass.1.par,
mass.aphid,mass.hov,mass.flea,mass.birds,mass.crop, mass.mam,mass.ot.flw)
mass.flea<-species_list %>% filter (taxon =="Rodent ectoparasite") %>%
mutate(biomass.g = 0.000765)
full_list<-rbind(mass.leaf.min.par,mass.seed.ins,mass.ins.par,mass.2.par,mass.1.par,
mass.aphid,mass.hov,mass.flea,mass.birds,mass.crop, mass.mam,mass.ot.flw)
View(mass.aphid)
View(mass.1.par)
View(mass.2.par)
View(mass.aphid)
View(mass.bees)
View(mass.birds)
View(mass.crop)
View(mass.flea)
View(mass.hov)
View(mass.ins.par)
View(mass.leaf.min.par)
View(mass.mam)
#check for those species in the repository that match in our dataframe
mass.mam<- species_list %>% left_join(mam.repo, by = "node_name") %>%
filter(taxon =="Seed-feeding rodent") %>% rename("biomass.g" = "Mass")
View(mass.mam)
View(mass.birds)
#birds
birds.repo<-read.delim("Data/biomass_repositories/BirdFuncDat.txt") %>%
select(Scientific,BodyMass.Value) %>% rename("node_name" = "Scientific",
"biomass.g" = "BodyMass.Value")
#check for those species in the repository that match in our dataframe
mass.birds<- species_list %>% left_join(birds.repo, by = "node_name") %>%
filter(taxon =="Seed-feeding bird")
# mammals
mam.repo<-read.delim("Data/biomass_repositories/MamFuncDat.txt")%>%
select(Scientific,BodyMass.Value) %>% rename("node_name" = "Scientific",
"biomass.g" = "BodyMass.Value")
#check for those species in the repository that match in our dataframe
mass.mam<- species_list %>% left_join(mam.repo, by = "node_name") %>%
filter(taxon =="Seed-feeding rodent") %>% rename("biomass.g" = "Mass")
#check for those species in the repository that match in our dataframe
mass.mam<- species_list %>% left_join(mam.repo, by = "node_name") %>%
filter(taxon =="Seed-feeding rodent")
full_list<-rbind(mass.leaf.min.par,mass.seed.ins,mass.ins.par,mass.2.par,mass.1.par,
mass.aphid,mass.hov,mass.flea,mass.birds,mass.crop, mass.mam,mass.ot.flw)
prueba<-full_list %>% group_by(taxon) %>% summarize(mean_mass = mean(biomass.g))
View(prueba)
aphid.par.repo<-read.delim("Data/biomass_repositories/bodysizes_2008.txt")
filter_sps<-aphid.par.repo %>% filter(Taxonomy.consumer%in%species_list$node_name |
Taxonomy.resource%in%species_list$node_name) %>%
select(Taxonomy.consumer,Mean.mass..g..consumer,Taxonomy.resource,
Mean.mass..g..resource) %>%  #filter sps from the database
unique() #the biomass is already averaged
#Split consumer and resource information
upper<- filter_sps[,1:2] %>% rename("node_name" = "Taxonomy.consumer", "biomass.g" ="Mean.mass..g..consumer")
lower<-filter_sps[,3:4] %>% rename("node_name" = "Taxonomy.resource", "biomass.g" ="Mean.mass..g..resource")
#function to keep the first two words in species name from the repository
keep_first_two_words <- function(text) {
words <- str_split(text, "\\s+")[[1]]
paste(words[1:2], collapse = " ")
}
#apply function
aphid.par.bio<-rbind(upper,lower) %>% unique() %>%
filter(biomass.g >0) %>% #eliminate species with - biomass (error in dataframe)
mutate( node_name = sapply(node_name, keep_first_two_words)) %>%
mutate(node_name = gsub("\\bNA\\b", "", node_name)) #eliminate extra text in some columns
#add data of biomass manually and do the average for the rest
mass.aphid<- species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>%  mutate (biomass.g = case_when(node_name == "Acyrthosiphon pisum"~ 0.0008623,
node_name == "Myzus persicae"~ 0.0002042,
node_name == "Sitobion avenae"~ 0.0031632,
TRUE~biomass.g)) %>%
filter(taxon == "Aphid") %>% mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g))
#add data of biomass manually and do the average for the rest
mass.1.par<-species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>% filter(taxon == "Primary aphid parasitoid") %>%
mutate (biomass.g = case_when(node_name == "Aphidius rhopalosiphi"~ 0.000161,
node_name == "Aphidius matricariae"~ 0.00088,
TRUE~biomass.g)) %>% #add manually more data
mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g))
mass.2.par<-species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>% filter(taxon == "Secondary aphid parasitoid")%>%
mutate (biomass.g = case_when(node_name == "Asaphes suspensus "~ 0.00000927,
TRUE~biomass.g)) %>% #add the data manually
mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g)) #do the average for the rest
## Insect seed feeder parasitoid
mass.ins.par<-species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>% filter(taxon == "Insect seed-feeder parasitoid") %>%
mutate (biomass.g = case_when(node_name == "Pteromalus albipennis"~ 0.0013,
node_name == "Mesopolobus incultus"~ 0.00045,
node_name == "Pteromalus elevatus"~ 0.0121,
node_name == "Bracon immutator"~ 0.0025,
node_name == "Bracon osculator"~ 0.0025,
node_name == "Bracon praecox"~ 0.0025,
TRUE~biomass.g)) %>% #add manually more data
mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g)) #do the average for the rest
mass.seed.ins<-species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>% filter(taxon == "Seed-feeding insect")  %>%
mutate (biomass.g = case_when(node_name == "Bruchidius varius"~ 0.003,
node_name == "Olibrus aeneus"~ 0.000251,
node_name == "Rhinocyllus conicus"~ 0.00845,
node_name == "Sitona lineatus"~ 0.00165,
node_name == "Urophora stylata"~ 0.0041,
TRUE~biomass.g)) %>% #add manually more data
mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g)) #do the average for the rest
## Leaf miners (do the average of all the parastioids (do it before averaging them)
mass.leaf.min.par<-species_list %>% left_join(aphid.par.bio, by = "node_name") %>%
unique() %>% filter(taxon == "Leaf-miner parasitoid")  %>%
mutate (biomass.g = case_when(node_name == "Bracon sp"~ 0.0025,
node_name == "Apanteles circumscriptus" ~ 0.0089,
node_name == "Anagrus sp A" ~ 0.0000288,
node_name == "Anagrus sp B" ~ 0.0000288,
node_name == "Anagrus sp C" ~ 0.0000288,
node_name == "Asaphes suspensus"~ 0.00000927,
node_name == "Chelonus sp"~ 0.0069,
node_name == "Chelonus sp aff rimatus"~ 0.0069,
node_name == "Chelonus scabrosus"~ 0.0069,
node_name == "Diadegma crataegi"~ 0.000674,
TRUE~biomass.g)) %>% #add manually more data
mutate(biomass.g =if_else(is.na(biomass.g),
mean(biomass.g, na.rm = TRUE), biomass.g)) #do the average for the rest
mass.flea<-species_list %>% filter (taxon =="Rodent ectoparasite") %>%
mutate(biomass.g = 0.000765)
mass.crop<-species_list %>% filter (taxon =="Crop") %>%
mutate (biomass.g = case_when(node_name == " Barley"~ 200,
node_name == " Lucerne" ~ 500,
node_name == " Oat spring" ~ 300,
node_name == " Oat winter" ~ 300,
node_name == " Triticale" ~ 500,
node_name == " Wheat"~ 250))#add manually more data
#repository of pollinators
library(pollimetry) #package containing data of pollinators
full_list<-rbind(mass.leaf.min.par,mass.seed.ins,mass.ins.par,mass.2.par,mass.1.par,
mass.aphid,mass.hov,mass.flea,mass.birds,mass.crop, mass.mam,mass.ot.flw)
prueba<-full_list %>% group_by(taxon) %>% summarize(mean_mass = mean(biomass.g))
View(prueba)
View(full_list)
