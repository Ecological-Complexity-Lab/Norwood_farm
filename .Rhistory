geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
labs(x = "Trophic guild",
y = "Relative percentage of trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
int_indirect_effecs
int_indirect_effecs<- int_trophic %>%
ggplot(aes(y=Prop, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 0.15),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
labs(x = "Trophic guild",
y = "Relative percentage of trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
int_indirect_effecs
int_indirect_effecs<- int_trophic %>%
ggplot(aes(y=Prop, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 1, by = 0.15)) +
labs(x = "Trophic guild",
y = "Relative percentage of trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
int_indirect_effecs
int_trophic<-Final_ES %>% filter(!is.na(node_int)) %>%
mutate(taxon_int =case_when(
node_int%in%plants ~ "Plant",
node_int%in%crops ~ "Crop",
node_int%in%flow_vis ~ "Flower visitor",
node_int%in%aphid ~ "Aphid",
node_int%in%pri_par ~ "Primary aphid parasitoid",
node_int%in%sec_par ~ "Secondary aphid parasitoid",
node_int%in%leaf_par ~ "Leaf-miner parasitoid",
node_int%in%seed_ins ~ "Seed-feeding insect",
node_int%in%seed_bird ~ "Seed-feeding bird",
node_int%in%seed_rod ~ "Seed-feeding rodent",
node_int%in%butt ~ "Butterfly",
node_int%in%seed_ins_par ~ "Insect seed-feeder parasitoid",
node_int%in%rod_par ~ "Rodent ectoparasite",
)) %>% select(node_int,taxon_int) %>%ungroup() %>%
mutate(Total = n()) %>% group_by(taxon_int) %>%
reframe(Number = n(), Perc = (Number /Total)*100) %>% unique() %>%
rename("taxon" = "taxon_int")
int_indirect_effecs<- int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 1, by = 0.15)) +
labs(x = "Trophic guild",
y = "Relative percentage of trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
int_indirect_effecs
int_indirect_effecs<- int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
int_indirect_effecs
#plot
pdf("Graphs/ind_effects_mediated.pdf", width = 12, height = 7)
int_indirect_effecs<- int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
dev.off()
#plot
pdf("Graphs/ind_effects_mediated.pdf", width = 12, height = 7)
int_indirect_effecs<- int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
#plot
pdf("Graphs/ind_effects_mediated.pdf", width = 12, height = 7)
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
dev.off()
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
#plot
pdf("Graphs/ind_effects_mediated.pdf", width = 12, height = 7)
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
dev.off()
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
int_trophic
s<-int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color = "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
s
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color= "black",size = 0.1)+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
#scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", linewidth= "black",size = 0.1)+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
#scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity", color= "black")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
#scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
#scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
#plot
pdf("Graphs/ind_effects_mediated.pdf", width = 12, height = 7)
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects mediated\nby trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
dev.off()
#plot
pdf("Graphs/ind_effects_mediated.pdf", width = 12, height = 7)
int_trophic %>%
ggplot(aes(y=Perc, x= taxon, fill = taxon)) +
geom_bar(position="stack", stat="identity")+
geom_text(aes(label = Number),  # Replace 'abundance_variable' with the actual column name for abundance
position = position_stack(vjust = 1),  # Adjust the position of the labels
size = 5, color = "black",
vjust = -0.5) +
scale_fill_manual(values = setNames(color_trophic$color, color_trophic$taxon))+
scale_color_manual(values = setNames(color_trophic$color, color_trophic$taxon)) +
scale_y_continuous(breaks = seq(0, 100, by = 15)) +
labs(x = "Trophic guild",
y = "Percentage of indirect effects on ES\nmediated by trophic guilds",
fill = "Trophic guild")+
theme_classic() +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.spacing = unit(0.5, "cm"),
axis.text = element_text(size = 15, color = 'black'),
axis.text.x = element_blank(),  # Remove x-axis labels
axis.title = element_text(size = 17, color = 'black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 12))
dev.off()
