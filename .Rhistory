install.packages("devtools")
install.packages("devtools")
install.packages("devtools")
devtools::install_github("manlius/muxViz")
remove.packages("muxViz")
devtools::install_github("manlius/muxViz")
library(htmltools)
library(htmltools)
install.packages("htmltools")
detach("package:htmltools", unload = TRUE)
install.packages("htmltools")
devtools::install_github("manlius/muxViz")
install.packages("htmltools")
devtools::install_github("manlius/muxViz")
library(emln)#multilayer package
page_rank_circ<-read.csv("Data/page_rank_sp.csv", sep = ",") %>%
filter(services == "all_mean") %>% #just average for now (maybe add error bars in the future)
spread(management,pagerank) %>% #rearrange dataframe
select(NodesID,services,E,SE,M,SI,I)  %>%
arrange(desc(E)) %>% slice(1:50)
#load packages
library(igraph)
library(dplyr)
library(tidyverse)
setwd("/Users/agustin/Desktop/Papers/Norwood_farm/Norwood_Tinio") #set directory
### PLOT CIRCULAR GRAPH OF THE FIRST 50 MOST IMPORTANT SPECIES IN EXTENSIVE
library(ggplot2)
library(circlize)
library(viridis)
library(ComplexHeatmap)
page_rank_circ<-read.csv("Data/page_rank_sp.csv", sep = ",") %>%
filter(services == "all_mean") %>% #just average for now (maybe add error bars in the future)
spread(management,pagerank) %>% #rearrange dataframe
select(NodesID,services,E,SE,M,SI,I)  %>%
arrange(desc(E)) %>% slice(1:50)
sp_names<-page_rank_circ[,1] #vector with nodes ID
page_rank_values<-page_rank_circ %>% select(-NodesID,-services) #dataframe just with pagerankvalues
row.names(page_rank_values)<-paste0(sp_names)
# Extensive layer
mean_E<- page_rank_values[,1]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.after = 20)
circos.heatmap(mean_E, col = color, rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# SemI-Extensive layer
mean_SE<- page_rank_values[,2]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.degree = 10)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_SE, col = color,rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# Moderate layer
mean_M<- page_rank_values[,3]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.degree = 10)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_M, col = color,rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# Semi-intensive layer
mean_SI<- page_rank_values[,4]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.after = 1)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_SI, col = color,rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# Intensive layer
mean_I<- page_rank_values[,5]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.after = 40)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_I, col = color,rownames.side = "outside", rownames.cex = 0.01, track.height = 0.15)
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1),  title_position = "topleft", title = "Page Rank", direction = "horizontal")
draw(lgd_mult, x = unit(1, "npc") - unit(30, "mm"), y = unit(6, "mm"),
just = c("right", "bottom"))
sp_names<-page_rank_circ[,1] #vector with nodes ID
page_rank_values<-page_rank_circ %>% select(-NodesID,-services) #dataframe just with pagerankvalues
rownames(page_rank_values) <- sp_names
# Extensive layer
mean_E<- page_rank_values[,1]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.after = 20)
circos.heatmap(mean_E, col = color, rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
circos.clear()
# Extensive layer
mean_E<- page_rank_values[,1]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.after = 20)
circos.heatmap(mean_E, col = color, rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# SemI-Extensive layer
mean_SE<- page_rank_values[,2]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.degree = 10)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_SE, col = color,rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# Moderate layer
mean_M<- page_rank_values[,3]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.degree = 10)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_M, col = color,rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# Semi-intensive layer
mean_SI<- page_rank_values[,4]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.after = 1)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_SI, col = color,rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# Intensive layer
mean_I<- page_rank_values[,5]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.after = 40)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_I, col = color,rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1),  title_position = "topleft", title = "Page Rank", direction = "horizontal")
draw(lgd_mult, x = unit(1, "npc") - unit(30, "mm"), y = unit(6, "mm"),
just = c("right", "bottom"))
circos.clear()
# Extensive layer
mean_E<- page_rank_values[,1]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.before  = 20)
circos.heatmap(mean_E, col = color, rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
?circos.par
circos.clear()
# Extensive layer
mean_E<- page_rank_values[,1]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.degree = 1)#
circos.heatmap(mean_E, col = color, rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# SemI-Extensive layer
mean_SE<- page_rank_values[,2]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.degree = 1)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_SE, col = color,rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
circos.clear()
# Extensive layer
mean_E<- page_rank_values[,1]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circle.margin(2)
circos.heatmap(mean_E, col = color, rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
circos.clear()
# Extensive layer
mean_E<- page_rank_values[,1]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circle.margin(2)
circos.heatmap(mean_E, col = color, rownames.side = "outside", rownames.cex = 1, track.height = 0.15)
circos.clear()
# Extensive layer
mean_E<- page_rank_values[,1]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circle.margin(2)
circos.heatmap(mean_E, col = color, rownames.side = "outside", rownames.cex = 1, track.height = 0.15)
# SemI-Extensive layer
mean_SE<- page_rank_values[,2]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.degree = 1)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_SE, col = color,rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# Moderate layer
mean_M<- page_rank_values[,3]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.degree = 10)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_M, col = color,rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# Semi-intensive layer
mean_SI<- page_rank_values[,4]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.after = 1)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_SI, col = color,rownames.side = "outside", rownames.cex = 2, track.height = 0.15)
# Extensive layer
mean_E<- page_rank_values[,1]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circle.margin(2)
circos.heatmap(mean_E, col = color, rownames.side = "outside", rownames.cex = 1, track.height = 0.15)
circos.clear()
# SemI-Extensive layer
mean_SE<- page_rank_values[,2]
# Extensive layer
mean_E<- page_rank_values[,1]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circle.margin(2)
circos.heatmap(mean_E, col = color, rownames.side = "outside", rownames.cex = 1, track.height = 0.15)
# SemI-Extensive layer
mean_SE<- page_rank_values[,2]
color = colorRamp2(seq(min(0.000088), max(0.06), length = 100),viridis(100))
circos.par(gap.degree = 1)#Empty a paragraph for adding label (E,SE,M,SI,I)
circos.heatmap(mean_SE, col = color, track.height = 0.15)
