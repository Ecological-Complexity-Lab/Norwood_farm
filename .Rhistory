D_taxon_ES_1<-taxon_ES_1 %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
taxon_ES_1<-rbind(taxon_tot_1,taxon_ES_1)
#Direct
D_taxon_ES_1<-taxon_ES_1 %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
#Indirect
I_taxon_ES_1<-taxon_ES_1 %>% filter(type == "I") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
taxon_ES_1<-rbind(taxon_tot_1,taxon_ES_1)
#Direct
D_taxon_ES_1<-taxon_ES_1 %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
#Indirect
I_taxon_ES_1<-taxon_ES_1 %>% filter(type == "I") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(D_taxon_ES_1 ,
I_taxon_ES_1 ,
ncol = 2)
#Indirect
I_taxon_ES_1<-taxon_ES_1 %>% filter(type == "I") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(D_taxon_ES_1 ,
I_taxon_ES_1 ,
ncol = 2)
upper_row
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
taxon_ES_1<-Final_ES %>% group_by(layer, type) %>% filter(services_to != "None", hop == 0 | hop ==1) %>%
mutate(Total = n()) %>% group_by(layer,type, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
taxon_tot_1<- Final_ES %>% group_by(type) %>% filter(services_to != "None",  hop == 0 |hop == 1) %>%
mutate(Total = n()) %>% group_by(type, taxon) %>%
summarize( layer= "Tot",Number = n(), Prop = Number /Total) %>% unique()
taxon_tot_1<-taxon_tot_1[,c(3,1,2,4,5)]
taxon_ES_1<-rbind(taxon_tot_1,taxon_ES_1)
#Direct
D_taxon_ES_1<-taxon_ES_1 %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(D_taxon_ES_1 ,
I_taxon_ES_1 ,
ncol = 2)
upper_row
knitr::opts_chunk$set(echo = FALSE, results = "asis", message=FALSE, warning=FALSE, cache=TRUE, eval = TRUE, dev = c('png'), out.width = '100%', out.height='40%')
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
taxon_ES_1<-Final_ES %>% group_by(layer, type) %>% filter(services_to != "None", hop == 0 | hop ==1) %>%
mutate(Total = n()) %>% group_by(layer,type, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
taxon_tot_1<-taxon_tot_1[,c(3,1,2,4,5)]
library(emln)#multilayer package
library(readr)
library(ggplot2)
setwd("D:/Trabajo/Papers/Norwood_Farm/norwood-ecosystem-services-main_Tinio")
library(cowplot)
output_ES<-read.csv ("Data/output_ES.csv", sep =",")
#1 hop
Prop_output<- output_ES %>%  group_by(layer, output) %>%
summarize(count= n()) %>% group_by(layer) %>% mutate(tot =sum(count)) %>%
group_by(layer,output) %>% summarize(prop = count/tot)
Hab_ES_output<-Prop_output%>%
ggplot(aes(y=prop, x=layer, fill =output)) +
geom_bar(position="stack", stat="identity")+ ggtitle("1 hop")+
labs(x='Habitat', y="Prop ES provided") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =13, angle = 90),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11),
legend.position = "bottom")
Hab_ES_output
View(output_ES)
# direct
Prop_output<- output_ES %>% filter(type == "D") %>%  group_by(layer, output) %>%
summarize(count= n()) %>% group_by(layer) %>% mutate(tot =sum(count)) %>%
group_by(layer,output) %>% summarize(prop = count/tot)
# indirect
Prop_output<- output_ES %>% filter(type == "I") %>%  group_by(layer, output) %>%
summarize(count= n()) %>% group_by(layer) %>% mutate(tot =sum(count)) %>%
group_by(layer,output) %>% summarize(prop = count/tot)
# direct
Prop_output<- output_ES %>%  group_by(type,layer, output) %>%
summarize(count= n()) %>% group_by(layer) %>% mutate(tot =sum(count)) %>%
group_by(layer,output) %>% summarize(prop = count/tot)
Hab_ES_output_dir<-Prop_output%>% filter(type =="D") %>%
ggplot(aes(y=prop, x=layer, fill =output)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct")+
labs(x='Habitat', y="Prop ES provided") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =13, angle = 90),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11),
legend.position = "bottom")
View(Prop_output)
# indirect
Prop_output_ind<- output_ES %>% filter(type == "I") %>%  group_by(layer, output) %>%
summarize(count= n()) %>% group_by(layer) %>% mutate(tot =sum(count)) %>%
group_by(layer,output) %>% summarize(prop = count/tot)
Hab_ES_output_ind<-Prop_output_ind%>%
ggplot(aes(y=prop, x=layer, fill =output)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect (2hops)")+
labs(x='Habitat', y="Prop ES provided") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =13, angle = 90),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11),
legend.position = "bottom")
Hab_ES_output_ind
Hab_ES_output_dir<-Prop_output%>%
ggplot(aes(y=prop, x=layer, fill =output)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct")+
labs(x='Habitat', y="Prop ES provided") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =13, angle = 90),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11),
legend.position = "bottom")
Hab_ES_output_dir
# indirect
Prop_output_ind<- output_ES %>% filter(type == "I") %>%  group_by(layer, output) %>%
summarize(count= n()) %>% group_by(layer) %>% mutate(tot =sum(count)) %>%
group_by(layer,output) %>% summarize(prop = count/tot)
Hab_ES_output_ind<-Prop_output_ind%>%
ggplot(aes(y=prop, x=layer, fill =output)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect (2hops)")+
labs(x='Habitat', y="Prop ES provided") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =13, angle = 90),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11),
legend.position = "bottom")
Hab_ES_output_ind
taxon_ES_output<-output_ES %>% group_by(layer, output)  %>%
mutate(Total = n()) %>% group_by(layer,output, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
#positive
taxon_ES_output_pos <-taxon_ES_output %>% filter(output =="+") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Positive")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
#negative
taxon_ES_output_neg <-taxon_ES_output %>% filter(output =="-") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Negative")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(taxon_ES_output_pos ,
taxon_ES_output_neg ,
ncol = 2)
upper_row
upper_row
upper_row<- plot_grid(Hab_ES_output_dir ,
Hab_ES_output_ind ,
ncol = 2)
upper_row
output_ES<-read.csv ("Data/output_ES.csv", sep =",")
# direct
Prop_output<- output_ES %>% filter(type == "D") %>%  group_by(layer, output) %>%
summarize(count= n()) %>% group_by(layer) %>% mutate(tot =sum(count)) %>%
group_by(layer,output) %>% summarize(prop = count/tot)
Hab_ES_output_dir<-Prop_output%>%
ggplot(aes(y=prop, x=layer, fill =output)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct")+
labs(x='Habitat', y="Prop ES provided") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =13, angle = 90),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11),
legend.position = "bottom")
# indirect
Prop_output_ind<- output_ES %>% filter(type == "I") %>%  group_by(layer, output) %>%
summarize(count= n()) %>% group_by(layer) %>% mutate(tot =sum(count)) %>%
group_by(layer,output) %>% summarize(prop = count/tot)
Hab_ES_output_ind<-Prop_output_ind%>%
ggplot(aes(y=prop, x=layer, fill =output)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect (2 hops)")+
labs(x='Habitat', y="Prop ES provided") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =13, angle = 90),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11),
legend.position = "bottom")
upper_row<- plot_grid(Hab_ES_output_dir ,
Hab_ES_output_ind ,
ncol = 2)
upper_row
taxon_ES_output_dir<-output_ES %>% filter (type == "D") %>% group_by(layer, output)  %>%
mutate(Total = n()) %>% group_by(layer,output, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
#positive
taxon_ES_output_pos_dir <-taxon_ES_output_dir %>% filter(output =="+") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Positive - Direct")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
taxon_ES_output_pos_dir
#negative
taxon_ES_output_neg_dir <-taxon_ES_output_dir %>% filter(output =="-") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Negative - Direct")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(taxon_ES_output_pos_dir ,
taxon_ES_output_neg_dir ,
ncol = 2)
upper_row
taxon_ES_output_ind<-output_ES %>% filter (type == "I") %>% group_by(layer, output)  %>%
mutate(Total = n()) %>% group_by(layer,output, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
#positive
taxon_ES_output_pos_ind <-taxon_ES_output_ind %>% filter(output =="+") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Positive - Direct")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
#negative
taxon_ES_output_neg_ind <-taxon_ES_output_ind %>% filter(output =="-") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Negative - Direct")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(taxon_ES_output_pos_ind ,
taxon_ES_output_neg_ind ,
ncol = 2)
upper_row
taxon_ES_output_ind<-output_ES %>% filter (type == "I") %>% group_by(layer, output)  %>%
mutate(Total = n()) %>% group_by(layer,output, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
#positive
taxon_ES_output_pos_ind <-taxon_ES_output_ind %>% filter(output =="+") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Positive - Indirect")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
#negative
taxon_ES_output_neg_ind <-taxon_ES_output_ind %>% filter(output =="-") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Negative - Indirect")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(taxon_ES_output_pos_ind ,
taxon_ES_output_neg_ind ,
ncol = 2)
upper_row
upper_row
