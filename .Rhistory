install.packages("devtools")
install.packages("devtools")
install.packages("devtools")
devtools::install_github("manlius/muxViz")
remove.packages("muxViz")
devtools::install_github("manlius/muxViz")
library(htmltools)
library(htmltools)
install.packages("htmltools")
detach("package:htmltools", unload = TRUE)
install.packages("htmltools")
devtools::install_github("manlius/muxViz")
install.packages("htmltools")
devtools::install_github("manlius/muxViz")
library(emln)#multilayer package
#load packages
library(igraph)
library(dplyr)
library(tidyverse)
#load packages
library(igraph)
library(dplyr)
library(tidyverse)
library(emln)
setwd("/Users/agustin/Desktop/Papers/Norwood_farm/Norwood_Tinio") #set directory
#upload and arrange dataframe
short_path_CP<-read.csv("Data/Land_use_shortpath_weighted_CP_intense.csv", row.names = 1) %>% mutate(land_use = "CP")
short_path_PP<-read.csv("Data/Land_use_shortpath_weighted_PP_intense.csv", row.names = 1)%>% mutate(land_use = "PP")
short_path_land_change<-rbind(short_path_CP,short_path_PP)
## check exploratory tendency
exploratory_taxon<-short_path_land_change %>% group_by(land_use,taxon) %>%
summarise(mean_short = mean(short_ave),
se_short = sd(short_ave)/ sqrt(n())) %>%
arrange(mean_short)
exploratory_management<-short_path_land_change %>% group_by(land_use,management) %>%
summarise(mean_short = mean(short_ave),
se_short = sd(short_ave)/ sqrt(n()))
#calculate average short path of each species to all E(D)S in each habitat management
short_path_land_change_ave<- short_path_land_change %>% group_by(land_use, management,node_id) %>%
mutate(short_path_ave = mean(short_ave)) %>% select(-services, - short_ave) %>% unique()
## From Extensive to intensive CP
short_path_land_change_CP<- short_path_land_change_ave %>% filter(land_use== "CP")
# Model
library(glmmTMB)
library(emmeans)
library(car)
short_CP<- glmmTMB(short_path_ave~management+taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_CP) #we already check and this is the best model
Anova(short_CP)
summary(short_CP)
short_CP<- glmmTMB(short_path_ave~management:taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_CP) #we already check and this is the best model
+
short_CP<- glmmTMB(short_path_ave~management+taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_CP) #we already check and this is the best model
Anova(short_CP)
summary(short_CP)
short_CP<- glmmTMB(short_path_ave~management+taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_CP) #we already check and this is the best model
Anova(short_CP)
summary(short_CP)
short_CP<- glmmTMB(short_path_ave~management:taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_CP) #we already check and this is the best model
short_CP<- glmmTMB(short_path_ave~management:taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_CP,
control = glmmTMBControl(optCtrl = list(maxfun = 10000)))) #we already check and this is the best model
short_CP<- glmmTMB(short_path_ave~management:taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_CP,
control = glmmTMBControl(optCtrl = list(maxfun = 10000))) #we already check and this is the best model
short_CP<- glmmTMB(short_path_ave~management:taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_CP,
control = glmmTMBControl(optimizer = nlminb,
optArgs = list(iter.max = 10000, eval.max = 10000))) #we already check and this is the best model
Anova(short_CP)
short_CP<- glmmTMB(short_path_ave~management + taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_CP) #we already check and this is the best model
Anova(short_CP)
summary(short_CP)
#Homogeneity
EM<-resid(short_CP, type= "response")
FM<-fitted(short_CP)
plot(x=FM, y=EM, xlab = "Ajustados", ylab = "Residuales normalizados")
abline(0,0, col="red", lwd= 3)
#independence
E1_lme<-resid(short_CP, type= "response")
boxplot(E1_lme~short_path_land_change_CP$management, main="Management")
# posthoc
post_amount<- emmeans(short_CP, ~ management)#management
pairs(post_amount)
post_amount_taxon<- emmeans(short_CP, ~ taxon)#management
pairs(post_amount_taxon)
## From Extensive to intensive PP
short_path_land_change_PP<- short_path_land_change_ave %>% filter(land_use== "PP")
# Model
short_PP<- glmmTMB(short_path_ave~management:taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_PP) #we already check and this is the best model
# Model
short_PP<- glmmTMB(short_path_ave~management:taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_PP,
control = glmmTMBControl(optimizer = nlminb,
optArgs = list(iter.max = 10000, eval.max = 10000)))) #we already check and this is the best model
# Model
short_PP<- glmmTMB(short_path_ave~management:taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_PP,
control = glmmTMBControl(optimizer = nlminb,
optArgs = list(iter.max = 10000, eval.max = 10000))) #we already check and this is the best model
# Model
short_PP<- glmmTMB(short_path_ave~management + taxon+ (1|node_id),
family = Gamma(link = "log"), data = short_path_land_change_PP) #we already check and this is the best model
Anova(short_PP)
summary(short_PP)
#Homogeneity
EM<-resid(short_PP, type= "response")
FM<-fitted(short_PP)
plot(x=FM, y=EM, xlab = "Ajustados", ylab = "Residuales normalizados")
abline(0,0, col="red", lwd= 3)
#independence
E1_lme<-resid(short_PP, type= "response")
boxplot(E1_lme~short_path_land_change_PP$management, main="Management")
# posthoc
post_amount<- emmeans(short_PP, ~ management)#management
pairs(post_amount)
