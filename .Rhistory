geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services), shape = ifelse(type == "Null", 24, 21)),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Prop. of direct E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Management")+
guides(fill = guide_legend(order = 1),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_direct
#Plot
prop_EDS_direct <- Prop_direct_sim%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Prop. of direct E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Management")+
guides(fill = guide_legend(order = 1),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_direct
#Plot
prop_EDS_direct <- Prop_direct_sim%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#2c7fb8','#e6ab02','#a6761d'), name = "Type")+
scale_y_continuous(name = "Prop. of direct E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Management")+
guides(fill = guide_legend(order = 1),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_direct
#Plot
prop_EDS_direct <- Prop_direct_sim%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#2c7fb8','#e6ab02','#a6761d'), name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Prop. of direct E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Management")+
guides(fill = guide_legend(order = 1),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_direct
#Plot
prop_EDS_direct <- Prop_direct_sim%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = TRUE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Prop. of direct E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Management")+
guides(fill = guide_legend(order = 1),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_direct
#Plot
prop_EDS_direct <- Prop_direct_sim%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Prop. of direct E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Management")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_direct
### Plot of proportions of indirect effects on E(D)S retained
Prop_ind_null<- read.csv("Data/Prop_ind_null_CP.csv", sep =",")
#Empirical
Prop_indir_Emp<-output_ind_ES %>% filter(iteration == "Emp") %>% group_by(management,services_to) %>%
mutate(tot = n()) %>% ungroup() %>%
group_by(services_to) %>%
mutate(prop = tot/max(tot)) %>%  #prop of indirect effects on E(D)S retained in the empirical
dplyr::select(management,services_to,tot,prop) %>%
unique() %>% rename("Prop_mean" = "prop") %>%
mutate (type = "Empirical")
#Simulations
Prop_indir_sim<- Prop_ind_null %>% group_by(management,services_to) %>%
summarise(Prop_mean = mean(Prop_mean)) %>%
filter(management !="E") %>% mutate(type = "Null")
# Merge empirical and simulations and remove extensive scenario
Prop_indir_sim2 <- rbind(Prop_indir_Emp, Prop_indir_sim)
Prop_indir_sim2$management <- factor(Prop_indir_sim2$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
#Plot
prop_EDS_indirect <- Prop_indir_sim2%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Prop. of indirect effects on E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Management")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_indirect
#Plot
prop_EDS_indirect <- Prop_indir_sim2%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services_to), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Prop. of indirect effects on E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Management")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_indirect
#Plot
prop_EDS_indirect <- Prop_indir_sim2%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services_to), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Prop. of indirect effects on E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Habitat conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_indirect
direct_ES_emp<- read.csv("Data/Land_use_dir_weighted_CP_intense.csv", sep =",") #upload empirical
extensive_amount <- direct_ES_emp %>%
filter(management == "E") %>%
group_by(management,services) %>%
summarize(tot_exten = sum(weight))
ratio_empirical <- direct_ES_emp  %>% group_by(management,services) %>%
summarize(tot = sum(weight)) %>%
left_join(extensive_amount[,2:3], by = "services", suffix = c("", "_extensive")) %>%
mutate(ratio_change_ave = tot / tot_exten) %>%  #ratio of change: values higher than 1 indicates increasing in the amount of E(D)S
mutate(type = "Empirical")
# Calculate ratio of change for simulations
direct_ES_sim<- read.csv("Data/direct_ES_sim_CP.csv", sep =",")
ratio_sim<- direct_ES_sim %>% filter (management !="E") %>%
group_by(management,iteration,services) %>%
summarize(tot = sum(weight)) %>%
left_join(extensive_amount[,2:3], by = "services", suffix = c("", "_extensive")) %>%
mutate(ratio_change = tot / tot_exten) %>% #ratio of change: values higher than 1 indicates increasing in the amount of E(D)S
group_by(management,services) %>%
summarise(ratio_change_ave = mean(ratio_change)) %>%
mutate(type = "Null")
#Join data
ratio_sim2<-rbind(ratio_empirical,ratio_sim)
ratio_sim2$management <- factor(ratio_sim2$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
#Plot
prop_EDS_ratio <- ratio_sim2%>% ggplot(aes(x = management, y = ratio_change_ave)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services_to), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Relative change in the amount of direct E(D)S provided", limits = c(0, 3)) +
scale_x_discrete(name = "Habitat conversion")+
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_ratio
#Plot
prop_EDS_ratio <- ratio_sim2%>% ggplot(aes(x = management, y = ratio_change_ave)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Relative change in the amount of direct E(D)S provided", limits = c(0, 3)) +
scale_x_discrete(name = "Habitat conversion")+
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_ratio
#Plot
prop_EDS_ratio <- ratio_sim2%>% ggplot(aes(x = management, y = ratio_change_ave)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Relative change in the amount of direct E(D)S provided", limits = c(0, 3)) +
scale_x_discrete(name = "Habitat conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_ratio
#upload and prepare dataframe
direct_ES<- read.csv("Data/direct_ES_sim_PP.csv", sep =",")
direct_ES$management <- factor(direct_ES$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
#indirect
output_ind_ES<- read.csv("Data/Indirect_ES_sim_PP.csv", sep =",")
output_ind_ES$management <- factor(output_ind_ES$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
### Plot of proportions of richness direct and indirect E(D)S retained
color_services <-tibble(
services = unique(direct_ES$services),
color = c('#1b9e77','#d95f02','#7570b3','#e7298a','#2c7fb8','#e6ab02','#a6761d'))
#Empirical
Prop_dir_emp<-direct_ES %>% filter(iteration == "Emp") %>% group_by(management,services) %>%
mutate(tot = n()) %>% ungroup() %>%
group_by(services) %>%
mutate(prop = tot/max(tot)) %>%  #prop of E(D)S rtained across habitat management
dplyr::select(management,services,tot,prop) %>%
unique() %>% rename("Prop_mean" = "prop") %>% mutate(type = "Emp")
# Value of empirical
values_emp<- Prop_dir_emp %>% filter (management == "E") %>% select(management,tot)
#Simulations
Prop_dir_sim<-direct_ES %>% filter(iteration != "Emp") %>% group_by(management,iteration,services) %>%
mutate(tot = n(),
tot_emp = case_when( #Values of denominator
services == "Crop production"~ 6,
services == "Pollination" ~ 117,
services == "Crop damage"~ 15,
services == "Pest control"~ 28,
services == "Seed dispersal" ~ 5,
services == "Butterfly watching"~ 16,
services == "Bird watching"~ 7 )) %>% ungroup() %>%
group_by(services) %>%
mutate(prop = tot/tot_emp) %>%  #prop of E(D)S rtained across habitat management per iteration and habitat management
dplyr::select(management,iteration,services,tot,prop) %>%
unique() %>% group_by(management,services) %>% summarise(Prop_mean = mean(prop)) %>%
mutate(type = "Null")
#join
Prop_direct_sim<-rbind(Prop_dir_emp,Prop_dir_sim)
#Plot
prop_EDS_direct <- Prop_direct_sim%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"), name = "Type")+
scale_y_continuous(name = "Prop. of direct E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Habitat conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_direct
#Empirical
Prop_indir_Emp<-output_ind_ES %>% filter(iteration == "Emp") %>% group_by(management,services_to) %>%
mutate(tot = n()) %>% ungroup() %>%
group_by(services_to) %>%
mutate(prop = tot/max(tot)) %>%  #prop of indirect effects on E(D)S retained in the empirical
dplyr::select(management,services_to,tot,prop) %>%
unique() %>% rename("Prop_mean" = "prop") %>%
mutate (type = "Empirical")
#Simulations
Prop_ind_null<- read.csv("Data/Prop_ind_null_PP.csv", sep =",")
Prop_indir_sim<- Prop_ind_null %>% group_by(management,services_to) %>%
summarise(Prop_mean = mean(Prop_mean)) %>%
filter(management !="E") %>% mutate(type = "Null")
# Merge empirical and simulations and remove extensive scenario
Prop_indir_sim2 <- rbind(Prop_indir_Emp, Prop_indir_sim)
Prop_indir_sim2$management <- factor(Prop_indir_sim2$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
#Plot
prop_EDS_indirect <- Prop_indir_sim2%>% ggplot(aes(x = management, y = Prop_mean)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services_to), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Prop. of indirect effects on E(D)S retained", limits = c(0, 1)) +
scale_x_discrete(name = "Habitat conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_indirect
extensive_amount <- direct_ES_emp %>%
filter(management == "E") %>%
group_by(management,services) %>%
summarize(tot_exten = sum(weight))
ratio_empirical <- direct_ES_emp  %>% group_by(management,services) %>%
summarize(tot = sum(weight)) %>%
left_join(extensive_amount[,2:3], by = "services", suffix = c("", "_extensive")) %>%
mutate(ratio_change_ave = tot / tot_exten) %>%  #ratio of change: values higher than 1 indicates increasing in the amount of E(D)S
mutate(type = "Empirical")
# Calculate ratio of change for simulations
direct_ES_sim<- read.csv("Data/direct_ES_sim_PP.csv", sep =",")
ratio_sim<- direct_ES_sim %>% filter (management !="E") %>%
group_by(management,iteration,services) %>%
summarize(tot = sum(weight)) %>%
left_join(extensive_amount[,2:3], by = "services", suffix = c("", "_extensive")) %>%
mutate(ratio_change = tot / tot_exten) %>% #ratio of change: values higher than 1 indicates increasing in the amount of E(D)S
group_by(management,services) %>%
summarise(ratio_change_ave = mean(ratio_change)) %>%
mutate(type = "Null")
#Join data
ratio_sim2<-rbind(ratio_empirical,ratio_sim)
ratio_sim2$management <- factor(ratio_sim2$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
#Plot
prop_EDS_ratio <- ratio_sim2%>% ggplot(aes(x = management, y = ratio_change_ave)) +
geom_boxplot(aes(colour = type), outlier.shape = NA, size = 1.1 ) +
geom_point(aes(fill = factor(services), shape = factor(ifelse(type == "Null", 24, 21))),
position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.4),
size = 2, stroke = 1, show.legend = c(fill = TRUE, shape = FALSE, colour = FALSE)) +
scale_fill_manual(values = color_services$color, name = "E(D)S") +
scale_shape_manual(values = c(21, 24)) +
scale_color_manual(values = c("black","firebrick"))+
scale_y_continuous(name = "Relative change in the amount of direct E(D)S provided", limits = c(0, 3)) +
scale_x_discrete(name = "Habitat conversion")+
guides(fill = guide_legend(order = 1,override.aes = list(shape=21)),
colour = guide_legend(order = 2),
shape = "none") +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major=element_line(color = "gray"),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=13, color='black'),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =14),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
prop_EDS_ratio
