install.packages("devtools")
install.packages("devtools")
install.packages("devtools")
devtools::install_github("manlius/muxViz")
remove.packages("muxViz")
devtools::install_github("manlius/muxViz")
library(htmltools)
library(htmltools)
install.packages("htmltools")
detach("package:htmltools", unload = TRUE)
install.packages("htmltools")
devtools::install_github("manlius/muxViz")
install.packages("htmltools")
devtools::install_github("manlius/muxViz")
library(emln)#multilayer package
#load packages
library(igraph)
library(dplyr)
library(tidyverse)
library(emln)#multilayer package
library(readr)
library(ggplot2)
library(cowplot)
setwd("/Users/agustin/Desktop/Papers/Norwood_farm/Norwood_Tinio")
#upload and prepare dataframe
direct_ES<- read.csv("Data/Land_use_dir_weighted_CP_intense.csv", sep =",") %>%
mutate(services = case_when(services == "Crop production"~ "Resource provision",
TRUE~services))
direct_ES$management <- factor(direct_ES$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
#direct
Number_direct<-direct_ES %>% group_by(management) %>% summarise(Number = n())
Number_dir<-Number_direct%>%
ggplot(aes(y=Number, x=management)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct")+
labs(x='Management', y="Number of direct E(D)S provision") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=11, color='black'),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank())
Number_dir
Number_indirect<-output_ind_ES %>% group_by(management) %>%
summarise(Number = n())
Number_indir<-Number_indirect%>%
ggplot(aes(y=Number, x=management)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect")+
labs(x='Management', y="Number of indirect effects on E(D)S") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=11, color='black'),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank())
Number_indir
#direct
direct_ES<- read.csv("Data/Land_use_dir_weighted_CP_intense.csv", sep =",") %>%
mutate(services = case_when(services == "Crop production"~ "Resource provision",
TRUE~services))
direct_ES$management <- factor(direct_ES$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
#indirect
output_ind_ES <- read.csv("Data/Land_use_output_weighted_CP_intense.csv", sep =",") %>%
mutate(services_to = case_when(services_to == "Crop production"~ "Resource provision",
TRUE~services_to))
output_ind_ES$management <- factor(output_ind_ES$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
#direct
Number_direct<-direct_ES %>% group_by(management) %>% summarise(Number = n())
Number_dir<-Number_direct%>%
ggplot(aes(y=Number, x=management)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct")+
labs(x='Management', y="Number of direct E(D)S provision") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=11, color='black'),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank())
Number_dir
Number_indirect<-output_ind_ES %>% group_by(management) %>%
summarise(Number = n())
Number_indir<-Number_indirect%>%
ggplot(aes(y=Number, x=management)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect")+
labs(x='Management', y="Number of indirect effects on E(D)S") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=11, color='black'),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank())
Number_indir
upper_row<- plot_grid(Number_dir,Number_indir ,
ncol = 2)
upper_row
ggsave("land_use_Number_CP_intense.png")
ggsave("land_use_Number_CP_intense.png")
#direct
direct_ES<- read.csv("Data/Land_use_dir_weighted_PP_intense.csv", sep =",") %>%
mutate(services = case_when(services == "Crop production"~ "Resource provision",
TRUE~services))
direct_ES$management <- factor(direct_ES$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
#indirect
output_ind_ES <- read.csv("Data/Land_use_output_weighted_PP_intense.csv", sep =",") %>%
mutate(services_to = case_when(services_to == "Crop production"~ "Resource provision",
TRUE~services_to))
output_ind_ES$management <- factor(output_ind_ES$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
#direct
Number_direct<-direct_ES %>% group_by(management) %>% summarise(Number = n())
Number_dir<-Number_direct%>%
ggplot(aes(y=Number, x=management)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct")+
labs(x='Management', y="Number of direct E(D)S provision") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=11, color='black'),
axis.text.x  = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank())
Number_dir
Number_indirect<-output_ind_ES %>% group_by(management) %>%
summarise(Number = n())
Number_indir<-Number_indirect%>%
ggplot(aes(y=Number, x=management)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect")+
labs(x='Management', y="Number of indirect effects on E(D)S") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text.y = element_text(size=11, color='black'),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank())
Number_indir
upper_row<- plot_grid(Number_dir,Number_indir ,
ncol = 2)
upper_row
ggsave("Land_use_number_PP_intense.png")
