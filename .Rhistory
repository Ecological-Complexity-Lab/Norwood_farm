# Pollination
PO<- top_25_values[,6,drop= FALSE]
circos.heatmap(PO, col = color, track.height = 0.05,  cell.border = "black")
# Seed dispersal
SD<- top_25_values[,7,drop= FALSE]
circos.heatmap(SD, col = color, track.height = 0.05,  cell.border = "black")
# Pest control
PC<- top_25_values[,5,drop= FALSE]
circos.heatmap(PC, col = color, track.height = 0.05,  cell.border = "black")
# Bird watching
BW<- top_25_values[,1,drop= FALSE]
circos.heatmap(BW, col = color, track.height = 0.05,  cell.border = "black")
# Butterfly watching
BTW<- top_25_values[,2,drop= FALSE]
circos.heatmap(BTW, col = color, track.height = 0.05,  cell.border = "black")
# Crop damage
CD<- top_25_values[,3,drop= FALSE]
circos.heatmap(CD, col = color, track.height = 0.05,  cell.border = "black")
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1), labels_gp = gpar(fontsize = 16),  title_position = "topleft", title = "Short path", direction = "horizontal",
grid_height = unit(1.6,"cm"),  grid_width = unit(5,"cm"),title_gp = gpar(fontsize = 20, fontface = "bold"))
draw(lgd_mult, x = unit(20, "mm"), y = unit(90, "mm"),
just = c("left", "bottom"))
dev.off()
species_list<- read.csv("Data/Land_use_shortpath_weighted_CP_intense.csv", sep =",", row.names = 1) %>%
separate(node_name, c("trophic_lower", "node_name"),  "[A-Z]\\.") %>%
select(-trophic_lower) %>% mutate (node_name =  gsub(c("\\?"), "", node_name)) %>%
mutate (node_name =  gsub(c("1"), "", node_name)) %>%
mutate (node_name =  gsub(c("zCROP"), "", node_name)) %>%
mutate (node_name = gsub("\\.", " ", node_name)) %>%
filter(node_name%in%sp_names)
View(species_list)
#sps
species_list<- read.csv("Data/Land_use_shortpath_weighted_CP_intense.csv", sep =",", row.names = 1) %>%
separate(node_name, c("trophic_lower", "node_name"),  "[A-Z]\\.") %>%
select(-trophic_lower) %>% mutate (node_name =  gsub(c("\\?"), "", node_name)) %>%
mutate (node_name =  gsub(c("1"), "", node_name)) %>%
mutate (node_name =  gsub(c("zCROP"), "", node_name)) %>%
mutate (node_name = gsub("\\.", " ", node_name)) %>%
filter(node_name%in%sp_names) %>% #filter species in the dataframe
mutate(color_sp =case_when(taxon == "Plant"~ "#00C1AB", #assign color to species according to the taxon
taxon == "Crop"~ "#BE9C00",
taxon == "Flower-visiting"~ "#8CAB00",
taxon == "Aphid"~ "#F8766D",
taxon == "Primary aphid parasitoid"~ "#00BBDA",
taxon == "Secondary aphid parasitoid"~ "#8B93FF",
taxon == "Leaf-miner parasitoid"~ "#00BE70",
taxon == "Seed-feeding insect"~ "#F962DD",
taxon == "Seed-feeding bird"~ "#D575FE",
taxon == "Seed-feeding rodent"~ "#FF65AC",
taxon == "Butterfly"~ "#E18A00",
taxon == "Insect seed-feeder parasitoid"~ "#24B700",
taxon == "Rodent ectoparasite"~ "#00ACFC") ) %>%
ungroup() %>% select(node_name,color_sp) %>% unique()
color_sp <- as.vector(species_list$color_sp)
sp_names<-short_top_25$node_name#vector with nodes ID
sp_names<-as.factor(sp_names) # to plot species name
top_25_values<- short_top_25 %>% select(-node_name)
rownames(top_25_values) <- sp_names
circos.clear()
png(file="Short_top25_Ext.png",
width=1600, height=1200)
# Crop production
CP<- top_25_values[,4, drop= FALSE]
# Define the border color for the heatmap cells
border_color = "black"  # You can choose any color
circos.heatmap(CP, col = color, rownames.side = "outside", rownames.col	=color_sp,
rownames.cex = 1.05, track.height = 0.1, cell.border = "black")
# Pollination
PO<- top_25_values[,6,drop= FALSE]
circos.heatmap(PO, col = color, track.height = 0.05,  cell.border = "black")
# Seed dispersal
SD<- top_25_values[,7,drop= FALSE]
circos.heatmap(SD, col = color, track.height = 0.05,  cell.border = "black")
# Pest control
PC<- top_25_values[,5,drop= FALSE]
circos.heatmap(PC, col = color, track.height = 0.05,  cell.border = "black")
# Bird watching
BW<- top_25_values[,1,drop= FALSE]
circos.heatmap(BW, col = color, track.height = 0.05,  cell.border = "black")
# Butterfly watching
BTW<- top_25_values[,2,drop= FALSE]
circos.heatmap(BTW, col = color, track.height = 0.05,  cell.border = "black")
# Crop damage
CD<- top_25_values[,3,drop= FALSE]
circos.heatmap(CD, col = color, track.height = 0.05,  cell.border = "black")
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1), labels_gp = gpar(fontsize = 16),  title_position = "topleft", title = "Short path", direction = "horizontal",
grid_height = unit(1.6,"cm"),  grid_width = unit(5,"cm"),title_gp = gpar(fontsize = 20, fontface = "bold"))
draw(lgd_mult, x = unit(20, "mm"), y = unit(90, "mm"),
just = c("left", "bottom"))
dev.off()
#Plotting
view(color_sp)
view(rownames(CP))
View(species_list)
View(short_top_25)
View(top_25_values)
species_list_ordered<-species_list[match(sp_names),species_list$node_name,]
species_list_ordered <- species_list[match(sp_names, species_list$node_name), ]
View(species_list_ordered)
color_sp<-species_list_ordered$color_sp
circos.clear()
png(file="Short_top25_Ext.png",
width=1600, height=1200)
# Crop production
CP<- top_25_values[,4, drop= FALSE]
# Define the border color for the heatmap cells
border_color = "black"  # You can choose any color
circos.heatmap(CP, col = color, rownames.side = "outside", rownames.col	=color_sp,
rownames.cex = 1.05, track.height = 0.1, cell.border = "black")
# Pollination
PO<- top_25_values[,6,drop= FALSE]
circos.heatmap(PO, col = color, track.height = 0.05,  cell.border = "black")
# Seed dispersal
SD<- top_25_values[,7,drop= FALSE]
circos.heatmap(SD, col = color, track.height = 0.05,  cell.border = "black")
# Pest control
PC<- top_25_values[,5,drop= FALSE]
circos.heatmap(PC, col = color, track.height = 0.05,  cell.border = "black")
# Bird watching
BW<- top_25_values[,1,drop= FALSE]
circos.heatmap(BW, col = color, track.height = 0.05,  cell.border = "black")
# Butterfly watching
BTW<- top_25_values[,2,drop= FALSE]
circos.heatmap(BTW, col = color, track.height = 0.05,  cell.border = "black")
# Crop damage
CD<- top_25_values[,3,drop= FALSE]
circos.heatmap(CD, col = color, track.height = 0.05,  cell.border = "black")
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1), labels_gp = gpar(fontsize = 16),  title_position = "topleft", title = "Short path", direction = "horizontal",
grid_height = unit(1.6,"cm"),  grid_width = unit(5,"cm"),title_gp = gpar(fontsize = 20, fontface = "bold"))
draw(lgd_mult, x = unit(20, "mm"), y = unit(90, "mm"),
just = c("left", "bottom"))
dev.off()
#layer
color = colorRampPalette(c("white", "red"))(30)
circos.clear()
png(file="Short_top25_Ext.png",
width=1600, height=1200)
# Crop production
CP<- top_25_values[,4, drop= FALSE]
# Define the border color for the heatmap cells
border_color = "black"  # You can choose any color
circos.heatmap(CP, col = color, rownames.side = "outside", rownames.col	=color_sp,
rownames.cex = 1.05, track.height = 0.1, cell.border = "black")
# Pollination
PO<- top_25_values[,6,drop= FALSE]
circos.heatmap(PO, col = color, track.height = 0.05,  cell.border = "black")
#layer
color = colorRampPalette(c("white", "red"))(30)
circos.clear()
png(file="Short_top25_Ext.png",
width=1600, height=1200)
# Crop production
CP<- top_25_values[,4, drop= FALSE]
# Define the border color for the heatmap cells
border_color = "black"  # You can choose any color
circos.heatmap(CP, col = color, rownames.side = "outside", rownames.col	=color_sp,
rownames.cex = 1.05, track.height = 0.1, cell.border = "black")
# Pollination
PO<- top_25_values[,6,drop= FALSE]
#layer
color = colorRamp2(seq(min(short_top_25[,2:8]), max(short_top_25[,2:8]), length = 50),heat(50)) #color layer
library(heat)
?heat
#layer
color = colorRamp2(seq(min(short_top_25[,2:8]), max(short_top_25[,2:8]), length = 50),heat.colors(50)) #color layer
#sps
species_list<- read.csv("Data/Land_use_shortpath_weighted_CP_intense.csv", sep =",", row.names = 1) %>%
separate(node_name, c("trophic_lower", "node_name"),  "[A-Z]\\.") %>%
select(-trophic_lower) %>% mutate (node_name =  gsub(c("\\?"), "", node_name)) %>%
mutate (node_name =  gsub(c("1"), "", node_name)) %>%
mutate (node_name =  gsub(c("zCROP"), "", node_name)) %>%
mutate (node_name = gsub("\\.", " ", node_name)) %>%
filter(node_name%in%sp_names) %>% #filter species in the dataframe
mutate(color_sp =case_when(taxon == "Plant"~ "#00C1AB", #assign color to species according to the taxon
taxon == "Crop"~ "#BE9C00",
taxon == "Flower-visiting"~ "#8CAB00",
taxon == "Aphid"~ "#F8766D",
taxon == "Primary aphid parasitoid"~ "#00BBDA",
taxon == "Secondary aphid parasitoid"~ "#8B93FF",
taxon == "Leaf-miner parasitoid"~ "#00BE70",
taxon == "Seed-feeding insect"~ "#F962DD",
taxon == "Seed-feeding bird"~ "#D575FE",
taxon == "Seed-feeding rodent"~ "#FF65AC",
taxon == "Butterfly"~ "#E18A00",
taxon == "Insect seed-feeder parasitoid"~ "#24B700",
taxon == "Rodent ectoparasite"~ "#00ACFC") ) %>%
ungroup() %>% select(node_name,color_sp) %>% unique()
sp_names<-short_top_25$node_name#vector with nodes ID
sp_names<-as.factor(sp_names) # to plot species name
top_25_values<- short_top_25 %>% select(-node_name)
rownames(top_25_values) <- sp_names
species_list_ordered <- species_list[match(sp_names, species_list$node_name), ]
color_sp<-species_list_ordered$color_sp
circos.clear()
png(file="Short_top25_Ext.png",
width=1600, height=1200)
# Crop production
CP<- top_25_values[,4, drop= FALSE]
# Define the border color for the heatmap cells
border_color = "black"  # You can choose any color
circos.heatmap(CP, col = color, rownames.side = "outside", rownames.col	=color_sp,
rownames.cex = 1.05, track.height = 0.1, cell.border = "black")
# Pollination
PO<- top_25_values[,6,drop= FALSE]
circos.heatmap(PO, col = color, track.height = 0.05,  cell.border = "black")
# Seed dispersal
SD<- top_25_values[,7,drop= FALSE]
circos.heatmap(SD, col = color, track.height = 0.05,  cell.border = "black")
# Pest control
PC<- top_25_values[,5,drop= FALSE]
circos.heatmap(PC, col = color, track.height = 0.05,  cell.border = "black")
# Bird watching
BW<- top_25_values[,1,drop= FALSE]
circos.heatmap(BW, col = color, track.height = 0.05,  cell.border = "black")
# Butterfly watching
BTW<- top_25_values[,2,drop= FALSE]
circos.heatmap(BTW, col = color, track.height = 0.05,  cell.border = "black")
# Crop damage
CD<- top_25_values[,3,drop= FALSE]
circos.heatmap(CD, col = color, track.height = 0.05,  cell.border = "black")
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1), labels_gp = gpar(fontsize = 16),  title_position = "topleft", title = "Short path", direction = "horizontal",
grid_height = unit(1.6,"cm"),  grid_width = unit(5,"cm"),title_gp = gpar(fontsize = 20, fontface = "bold"))
draw(lgd_mult, x = unit(20, "mm"), y = unit(90, "mm"),
just = c("left", "bottom"))
dev.off()
#layer
color = colorRamp2(seq(min(short_top_25[,2:8]), max(short_top_25[,2:8]), length = 50),magma(50)) #color layer
#sps
species_list<- read.csv("Data/Land_use_shortpath_weighted_CP_intense.csv", sep =",", row.names = 1) %>%
separate(node_name, c("trophic_lower", "node_name"),  "[A-Z]\\.") %>%
select(-trophic_lower) %>% mutate (node_name =  gsub(c("\\?"), "", node_name)) %>%
mutate (node_name =  gsub(c("1"), "", node_name)) %>%
mutate (node_name =  gsub(c("zCROP"), "", node_name)) %>%
mutate (node_name = gsub("\\.", " ", node_name)) %>%
filter(node_name%in%sp_names) %>% #filter species in the dataframe
mutate(color_sp =case_when(taxon == "Plant"~ "#00C1AB", #assign color to species according to the taxon
taxon == "Crop"~ "#BE9C00",
taxon == "Flower-visiting"~ "#8CAB00",
taxon == "Aphid"~ "#F8766D",
taxon == "Primary aphid parasitoid"~ "#00BBDA",
taxon == "Secondary aphid parasitoid"~ "#8B93FF",
taxon == "Leaf-miner parasitoid"~ "#00BE70",
taxon == "Seed-feeding insect"~ "#F962DD",
taxon == "Seed-feeding bird"~ "#D575FE",
taxon == "Seed-feeding rodent"~ "#FF65AC",
taxon == "Butterfly"~ "#E18A00",
taxon == "Insect seed-feeder parasitoid"~ "#24B700",
taxon == "Rodent ectoparasite"~ "#00ACFC") ) %>%
ungroup() %>% select(node_name,color_sp) %>% unique()
sp_names<-short_top_25$node_name#vector with nodes ID
sp_names<-as.factor(sp_names) # to plot species name
top_25_values<- short_top_25 %>% select(-node_name)
rownames(top_25_values) <- sp_names
species_list_ordered <- species_list[match(sp_names, species_list$node_name), ]
color_sp<-species_list_ordered$color_sp
circos.clear()
png(file="Short_top25_Ext.png",
width=1600, height=1200)
# Crop production
CP<- top_25_values[,4, drop= FALSE]
# Define the border color for the heatmap cells
border_color = "black"  # You can choose any color
circos.heatmap(CP, col = color, rownames.side = "outside", rownames.col	=color_sp,
rownames.cex = 1.05, track.height = 0.1, cell.border = "black")
# Pollination
PO<- top_25_values[,6,drop= FALSE]
circos.heatmap(PO, col = color, track.height = 0.05,  cell.border = "black")
# Seed dispersal
SD<- top_25_values[,7,drop= FALSE]
circos.heatmap(SD, col = color, track.height = 0.05,  cell.border = "black")
# Pest control
PC<- top_25_values[,5,drop= FALSE]
circos.heatmap(PC, col = color, track.height = 0.05,  cell.border = "black")
# Bird watching
BW<- top_25_values[,1,drop= FALSE]
circos.heatmap(BW, col = color, track.height = 0.05,  cell.border = "black")
# Butterfly watching
BTW<- top_25_values[,2,drop= FALSE]
circos.heatmap(BTW, col = color, track.height = 0.05,  cell.border = "black")
# Crop damage
CD<- top_25_values[,3,drop= FALSE]
circos.heatmap(CD, col = color, track.height = 0.05,  cell.border = "black")
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1), labels_gp = gpar(fontsize = 16),  title_position = "topleft", title = "Short path", direction = "horizontal",
grid_height = unit(1.6,"cm"),  grid_width = unit(5,"cm"),title_gp = gpar(fontsize = 20, fontface = "bold"))
draw(lgd_mult, x = unit(20, "mm"), y = unit(90, "mm"),
just = c("left", "bottom"))
dev.off()
### SAME PLOT WITH CIRCLIZE
library(circlize)
library(viridis)
library(ComplexHeatmap)
top_25_sp
short_top_25<-top_25_sp %>% #just average for now (maybe add error bars in the future)
select(node_name,services,short_ave) %>%
spread(services,short_ave)  #rearrange dataframe
sp_names <- short_top_25$node_name #create temporal species name to filter the big database
#layer
color = colorRamp2(seq(min(short_top_25[,2:8]), max(short_top_25[,2:8]), length = 50),viridis(50)) #color layer
#sps
species_list<- read.csv("Data/Land_use_shortpath_weighted_CP_intense.csv", sep =",", row.names = 1) %>%
separate(node_name, c("trophic_lower", "node_name"),  "[A-Z]\\.") %>%
select(-trophic_lower) %>% mutate (node_name =  gsub(c("\\?"), "", node_name)) %>%
mutate (node_name =  gsub(c("1"), "", node_name)) %>%
mutate (node_name =  gsub(c("zCROP"), "", node_name)) %>%
mutate (node_name = gsub("\\.", " ", node_name)) %>%
filter(node_name%in%sp_names) %>% #filter species in the dataframe
mutate(color_sp =case_when(taxon == "Plant"~ "#00C1AB", #assign color to species according to the taxon
taxon == "Crop"~ "#BE9C00",
taxon == "Flower-visiting"~ "#8CAB00",
taxon == "Aphid"~ "#F8766D",
taxon == "Primary aphid parasitoid"~ "#00BBDA",
taxon == "Secondary aphid parasitoid"~ "#8B93FF",
taxon == "Leaf-miner parasitoid"~ "#00BE70",
taxon == "Seed-feeding insect"~ "#F962DD",
taxon == "Seed-feeding bird"~ "#D575FE",
taxon == "Seed-feeding rodent"~ "#FF65AC",
taxon == "Butterfly"~ "#E18A00",
taxon == "Insect seed-feeder parasitoid"~ "#24B700",
taxon == "Rodent ectoparasite"~ "#00ACFC") ) %>%
ungroup() %>% select(node_name,color_sp) %>% unique()
sp_names<-short_top_25$node_name#vector with nodes ID
sp_names<-as.factor(sp_names) # to plot species name
top_25_values<- short_top_25 %>% select(-node_name)
rownames(top_25_values) <- sp_names
species_list_ordered <- species_list[match(sp_names, species_list$node_name), ]
color_sp<-species_list_ordered$color_sp
circos.clear()
png(file="Short_top25_Ext.png",
width=1600, height=1200)
# Crop production
CP<- top_25_values[,4, drop= FALSE]
# Define the border color for the heatmap cells
border_color = "black"  # You can choose any color
circos.heatmap(CP, col = color, rownames.side = "outside", rownames.col	=color_sp,
rownames.cex = 1.05, track.height = 0.1, cell.border = "black")
# Pollination
PO<- top_25_values[,6,drop= FALSE]
circos.heatmap(PO, col = color, track.height = 0.05,  cell.border = "black")
# Seed dispersal
SD<- top_25_values[,7,drop= FALSE]
circos.heatmap(SD, col = color, track.height = 0.05,  cell.border = "black")
# Pest control
PC<- top_25_values[,5,drop= FALSE]
circos.heatmap(PC, col = color, track.height = 0.05,  cell.border = "black")
# Bird watching
BW<- top_25_values[,1,drop= FALSE]
circos.heatmap(BW, col = color, track.height = 0.05,  cell.border = "black")
# Butterfly watching
BTW<- top_25_values[,2,drop= FALSE]
circos.heatmap(BTW, col = color, track.height = 0.05,  cell.border = "black")
# Crop damage
CD<- top_25_values[,3,drop= FALSE]
circos.heatmap(CD, col = color, track.height = 0.05,  cell.border = "black")
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1), labels_gp = gpar(fontsize = 16),  title_position = "topleft", title = "Short path", direction = "horizontal",
grid_height = unit(1.6,"cm"),  grid_width = unit(8,"cm"),title_gp = gpar(fontsize = 20, fontface = "bold"))
draw(lgd_mult, x = unit(20, "mm"), y = unit(90, "mm"),
just = c("left", "bottom"))
dev.off()
circos.clear()
png(file="Short_top25_Ext.png",
width=1600, height=1200)
# Crop production
CP<- top_25_values[,4, drop= FALSE]
# Define the border color for the heatmap cells
border_color = "black"  # You can choose any color
circos.heatmap(CP, col = color, rownames.side = "outside", rownames.col	=color_sp,
rownames.cex = 1.05, track.height = 0.1, cell.border = "black")
# Pollination
PO<- top_25_values[,6,drop= FALSE]
circos.heatmap(PO, col = color, track.height = 0.05,  cell.border = "black")
# Seed dispersal
SD<- top_25_values[,7,drop= FALSE]
circos.heatmap(SD, col = color, track.height = 0.05,  cell.border = "black")
# Pest control
PC<- top_25_values[,5,drop= FALSE]
circos.heatmap(PC, col = color, track.height = 0.05,  cell.border = "black")
# Bird watching
BW<- top_25_values[,1,drop= FALSE]
circos.heatmap(BW, col = color, track.height = 0.05,  cell.border = "black")
# Butterfly watching
BTW<- top_25_values[,2,drop= FALSE]
circos.heatmap(BTW, col = color, track.height = 0.05,  cell.border = "black")
# Crop damage
CD<- top_25_values[,3,drop= FALSE]
circos.heatmap(CD, col = color, track.height = 0.05,  cell.border = "black")
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1), labels_gp = gpar(fontsize = 16),  title_position = "topleft", title = "Short path", direction = "horizontal",
grid_height = unit(2,"cm"),  grid_width = unit(9,"cm"),title_gp = gpar(fontsize = 20, fontface = "bold"))
draw(lgd_mult, x = unit(20, "mm"), y = unit(90, "mm"),
just = c("left", "bottom"))
dev.off()
circos.clear()
png(file="Short_top25_Ext.png",
width=1600, height=1200)
# Crop production
CP<- top_25_values[,4, drop= FALSE]
# Define the border color for the heatmap cells
border_color = "black"  # You can choose any color
circos.heatmap(CP, col = color, rownames.side = "outside", rownames.col	=color_sp,
rownames.cex = 1.05, track.height = 0.1, cell.border = "black")
# Pollination
PO<- top_25_values[,6,drop= FALSE]
circos.heatmap(PO, col = color, track.height = 0.05,  cell.border = "black")
# Seed dispersal
SD<- top_25_values[,7,drop= FALSE]
circos.heatmap(SD, col = color, track.height = 0.05,  cell.border = "black")
# Pest control
PC<- top_25_values[,5,drop= FALSE]
circos.heatmap(PC, col = color, track.height = 0.05,  cell.border = "black")
# Bird watching
BW<- top_25_values[,1,drop= FALSE]
circos.heatmap(BW, col = color, track.height = 0.05,  cell.border = "black")
# Butterfly watching
BTW<- top_25_values[,2,drop= FALSE]
circos.heatmap(BTW, col = color, track.height = 0.05,  cell.border = "black")
# Crop damage
CD<- top_25_values[,3,drop= FALSE]
circos.heatmap(CD, col = color, track.height = 0.05,  cell.border = "black")
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1), labels_gp = gpar(fontsize = 20),  title_position = "topleft", title = "Short path", direction = "horizontal",
grid_height = unit(1.6,"cm"),  grid_width = unit(11,"cm"),title_gp = gpar(fontsize = 20, fontface = "bold"))
draw(lgd_mult, x = unit(20, "mm"), y = unit(90, "mm"),
just = c("left", "bottom"))
dev.off()
#layer
color = colorRamp2(seq(max(short_top_25[,2:8], min(short_top_25[,2:8]),), length = 50),viridis(50)) #color layer
#layer
color = colorRamp2(seq(max(short_top_25[,2:8], min(short_top_25[,2:8])), length = 50),viridis(50)) #color layer
circos.clear()
png(file="Short_top25_Ext.png",
width=1600, height=1200)
# Crop production
CP<- top_25_values[,4, drop= FALSE]
# Define the border color for the heatmap cells
border_color = "black"  # You can choose any color
circos.heatmap(CP, col = color, rownames.side = "outside", rownames.col	=color_sp,
rownames.cex = 1.06, track.height = 0.1, cell.border = "black")
# Pollination
PO<- top_25_values[,6,drop= FALSE]
circos.heatmap(PO, col = color, track.height = 0.05,  cell.border = "black")
# Seed dispersal
SD<- top_25_values[,7,drop= FALSE]
circos.heatmap(SD, col = color, track.height = 0.05,  cell.border = "black")
# Pest control
PC<- top_25_values[,5,drop= FALSE]
circos.heatmap(PC, col = color, track.height = 0.05,  cell.border = "black")
# Bird watching
BW<- top_25_values[,1,drop= FALSE]
circos.heatmap(BW, col = color, track.height = 0.05,  cell.border = "black")
# Butterfly watching
BTW<- top_25_values[,2,drop= FALSE]
circos.heatmap(BTW, col = color, track.height = 0.05,  cell.border = "black")
# Crop damage
CD<- top_25_values[,3,drop= FALSE]
circos.heatmap(CD, col = color, track.height = 0.05,  cell.border = "black")
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1), labels_gp = gpar(fontsize = 20),  title_position = "topleft", title = "Short path", direction = "horizontal",
grid_height = unit(1.6,"cm"),  grid_width = unit(11,"cm"),title_gp = gpar(fontsize = 20, fontface = "bold"))
draw(lgd_mult, x = unit(20, "mm"), y = unit(90, "mm"),
just = c("left", "bottom"))
dev.off()
#layer
color = colorRamp2(seq(max(short_top_25[,2:8]), min(short_top_25[,2:8]), length = 50),viridis(50)) #color layer
circos.clear()
png(file="Short_top25_Ext.png",
width=1600, height=1200)
# Crop production
CP<- top_25_values[,4, drop= FALSE]
# Define the border color for the heatmap cells
border_color = "black"  # You can choose any color
circos.heatmap(CP, col = color, rownames.side = "outside", rownames.col	=color_sp,
rownames.cex = 1.06, track.height = 0.1, cell.border = "black")
# Pollination
PO<- top_25_values[,6,drop= FALSE]
circos.heatmap(PO, col = color, track.height = 0.05,  cell.border = "black")
# Seed dispersal
SD<- top_25_values[,7,drop= FALSE]
circos.heatmap(SD, col = color, track.height = 0.05,  cell.border = "black")
# Pest control
PC<- top_25_values[,5,drop= FALSE]
circos.heatmap(PC, col = color, track.height = 0.05,  cell.border = "black")
# Bird watching
BW<- top_25_values[,1,drop= FALSE]
circos.heatmap(BW, col = color, track.height = 0.05,  cell.border = "black")
# Butterfly watching
BTW<- top_25_values[,2,drop= FALSE]
circos.heatmap(BTW, col = color, track.height = 0.05,  cell.border = "black")
# Crop damage
CD<- top_25_values[,3,drop= FALSE]
circos.heatmap(CD, col = color, track.height = 0.05,  cell.border = "black")
#Legend
lgd_mult = Legend(col_fun =color,
legend_gp = gpar(col = 1), labels_gp = gpar(fontsize = 20),  title_position = "topleft", title = "Short path", direction = "horizontal",
grid_height = unit(1.6,"cm"),  grid_width = unit(11,"cm"),title_gp = gpar(fontsize = 20, fontface = "bold"))
draw(lgd_mult, x = unit(20, "mm"), y = unit(90, "mm"),
just = c("left", "bottom"))
dev.off()
