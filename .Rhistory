matched_nodes <- match(V(M_CP2)$name, nodes$node_id)
is.igraph(M_CP2)
View(M_CP2)
V(M_CP2)
V(M_CP2)$taxon
V(M_CP2)$color
V(E)$taxon
# Set up a multi-panel layout: 1 row, 3 columns
par(mfrow = c(1, 3), mar = c(0.2, 0.2, 2, 0.2))
# Function to plot network
plot_network <- function(edge_data, nodes, title_text) {
g <- graph_from_edgelist(as.matrix(edge_data), directed = FALSE)
isolated_nodes <- which(degree(g) == 0)
g <- delete_vertices(g, isolated_nodes)
# Match nodes and assign attributes
node_match <- match(V(g)$name, nodes$node_id)
V(g)$taxon <- nodes$taxon[node_match]
V(g)$color <- color_trophic$color[match(V(g)$taxon, color_trophic$taxon)]
# Plot
plot(g, edge.arrow.size = .5, vertex.color = V(g)$color, vertex.size = 4, vertex.label = NA,
vertex.frame.color = "black", vertex.label.color = "black",
vertex.label.cex = .5, vertex.label.dist = 0.5, edge.curved = 0.2)
title(main = title_text, cex.main = 1.5)
}
# EXTENSIVE network plot
E_edge <- edge_list %>% filter(management == "E") %>% select(node_from, node_to)
plot_network(E_edge, nodes, "EXTENSIVE")
Norwood_farm<-readRDS("Data/Norwood_farm.RData") #read multilayer object to get the node's list
nodes<- Norwood_farm$nodes %>% #node list with attributes
mutate(taxon = str_replace(taxon, "Flower-visiting", "Flower visitor"))
edge_list<-read.csv("Data/Land_use_rat_edgelist_weighted_CP_intense.csv", sep =",") %>%
mutate(weight == 1) #edge list
# Define color scheme for taxa
color_trophic <- tibble(taxon = c("Plant", "Crop", "Flower visitor", "Aphid", "Primary aphid parasitoid",
"Secondary aphid parasitoid", "Leaf-miner parasitoid", "Seed-feeding insect",
"Seed-feeding bird", "Seed-feeding rodent", "Butterfly",
"Insect seed-feeder parasitoid", "Rodent ectoparasite"),
color = c("#33a02c", "#b15928", "#a6cee3", "#1f78b4", "#b2df8a",
"#fb9a99", "#e31a1c", "#fdbf6f", "#ff7f00", "#cab2d6",
"#6a3d9a", "#ffff99", "#e7298a"))
# Set up a multi-panel layout: 1 row, 3 columns
par(mfrow = c(1, 3), mar = c(0.2, 0.2, 2, 0.2))
# Function to plot network
plot_network <- function(edge_data, nodes, title_text) {
g <- graph_from_edgelist(as.matrix(edge_data), directed = FALSE)
isolated_nodes <- which(degree(g) == 0)
g <- delete_vertices(g, isolated_nodes)
# Match nodes and assign attributes
node_match <- match(V(g)$name, nodes$node_id)
V(g)$taxon <- nodes$taxon[node_match]
V(g)$color <- color_trophic$color[match(V(g)$taxon, color_trophic$taxon)]
# Plot
plot(g, edge.arrow.size = .5, vertex.color = V(g)$color, vertex.size = 4, vertex.label = NA,
vertex.frame.color = "black", vertex.label.color = "black",
vertex.label.cex = .5, vertex.label.dist = 0.5, edge.curved = 0.2)
title(main = title_text, cex.main = 1.5)
}
# EXTENSIVE network plot
E_edge <- edge_list %>% filter(management == "E") %>% select(node_from, node_to)
plot_network(E_edge, nodes, "EXTENSIVE")
# Set up a multi-panel layout: 1 row, 3 columns
par(mfrow = c(1, 3), mar = c(0.2, 0.2, 2, 0.2))
# Function to plot network
plot_network <- function(edge_data, nodes, title_text) {
g <- graph_from_edgelist(as.matrix(edge_data), directed = FALSE)
isolated_nodes <- which(degree(g) == 0)
g <- delete_vertices(g, isolated_nodes)
# Match nodes and assign attributes
matched_indices <- match(V(g)$name, nodes$node_id)
# Only assign if there's a valid match
valid_matches <- !is.na(matched_indices)
node_match <- match(V(g)$name, nodes$node_id)
V(g)$taxon <- nodes$taxon[node_match]
V(g)$color <- color_trophic$color[match(V(g)$taxon, color_trophic$taxon)]
# Plot
plot(g, edge.arrow.size = .5, vertex.color = V(g)$color, vertex.size = 4, vertex.label = NA,
vertex.frame.color = "black", vertex.label.color = "black",
vertex.label.cex = .5, vertex.label.dist = 0.5, edge.curved = 0.2)
title(main = title_text, cex.main = 1.5)
}
# EXTENSIVE network plot
E_edge <- edge_list %>% filter(management == "E") %>% select(node_from, node_to)
plot_network(E_edge, nodes, "EXTENSIVE")
# Only assign if there's a valid match
valid_matches <- !is.na(matched_indices)
node_match <- match(V(g)$name, nodes$node_id)
V(g)$taxon <- rep(NA, vcount(g))  # Initialize with NA
V(g)$taxon[valid_matches] <- nodes$taxon[matched_indices[valid_matches]]
# Set up a multi-panel layout: 1 row, 3 columns
par(mfrow = c(1, 3), mar = c(0.2, 0.2, 2, 0.2))
# Function to plot network
plot_network <- function(edge_data, nodes, title_text) {
g <- graph_from_edgelist(as.matrix(edge_data), directed = FALSE)
isolated_nodes <- which(degree(g) == 0)
g <- delete_vertices(g, isolated_nodes)
# Match nodes and assign attributes
matched_indices <- match(V(g)$name, nodes$node_id)
# Only assign if there's a valid match
valid_matches <- !is.na(matched_indices)
node_match <- match(V(g)$name, nodes$node_id)
V(g)$taxon <- rep(NA, vcount(g))  # Initialize with NA
V(g)$taxon[valid_matches] <- nodes$taxon[matched_indices[valid_matches]]
# Plot
plot(g, edge.arrow.size = .5, vertex.color = V(g)$color, vertex.size = 4, vertex.label = NA,
vertex.frame.color = "black", vertex.label.color = "black",
vertex.label.cex = .5, vertex.label.dist = 0.5, edge.curved = 0.2)
title(main = title_text, cex.main = 1.5)
}
# EXTENSIVE network plot
E_edge <- edge_list %>% filter(management == "E") %>% select(node_from, node_to)
plot_network(E_edge, nodes, "EXTENSIVE")
library(igraph)
library(tidyverse)
setwd("/Users/agustin/Desktop/Papers/Norwood_farm/Norwood_Tinio")
Norwood_farm<-readRDS("Data/Norwood_farm.RData") #read multilayer object to get the node's list
nodes<- Norwood_farm$nodes #node list with attributes
edge_list<-read.csv("Data/Land_use_rat_edgelist_weighted_CP_intense.csv", sep =",") %>%
mutate(weight == 1) #edge list
E_edge <- edge_list %>% filter(management == "E") %>% select(node_from,node_to)
E<- graph_from_edgelist(as.matrix(E_edge), directed = FALSE) #create igraph object
S <- vcount(E)#number of species
L <- ecount(E) #number of links
nodes<- Norwood_farm$nodes %>%
mutate(taxon = str_replace(taxon, "Flower-visiting", "Flower visitor")) #node list with attributes
edge_list<-read.csv("Data/Land_use_rat_edgelist_weighted_CP_intense.csv", sep =",") %>%
mutate(weight == 1) #edge list
E_edge <- edge_list %>% filter(management == "E") %>% select(node_from,node_to)
E<- graph_from_edgelist(as.matrix(E_edge), directed = FALSE) #create igraph object
S <- vcount(E)#number of species
L <- ecount(E) #number of links
color_trophic <-tibble(taxon = c("Plant","Crop","Flower-visiting","Aphid","Primary aphid parasitoid","Secondary aphid parasitoid",
"Leaf-miner parasitoid","Seed-feeding insect","Seed-feeding bird",
"Seed-feeding rodent","Butterfly","Insect seed-feeder parasitoid","Rodent ectoparasite"),
color = c("#33a02c","#b15928","#a6cee3","#1f78b4","#b2df8a","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6",
"#6a3d9a", "#ffff99", "#e7298a"))
color_trophic <-tibble(taxon = c("Plant","Crop","Flower visitor","Aphid","Primary aphid parasitoid","Secondary aphid parasitoid",
"Leaf-miner parasitoid","Seed-feeding insect","Seed-feeding bird",
"Seed-feeding rodent","Butterfly","Insect seed-feeder parasitoid","Rodent ectoparasite"),
color = c("#33a02c","#b15928","#a6cee3","#1f78b4","#b2df8a","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6",
"#6a3d9a", "#ffff99", "#e7298a"))
# assign attributes according to the taxon
V(E)$taxon<-nodes$taxon #create taxon attribute
#create color of taxon as attributes
vcol=V(E)$taxon
vcol[vcol== "Plant"]="#33a02c"
vcol[vcol=="Crop"]="#b15928"
vcol[vcol=="Flower-visiting"]="#a6cee3"
vcol[vcol== "Aphid"]="#1f78b4"
vcol[vcol=="Primary aphid parasitoid"]="#b2df8a"
vcol[vcol=="Secondary aphid parasitoid"]="#fb9a99"
vcol[vcol=="Leaf-miner parasitoid"]="#e31a1c"
vcol[vcol== "Seed-feeding insect"]="#fdbf6f"
vcol[vcol=="Seed-feeding bird"]="#ff7f00"
vcol[vcol=="Seed-feeding rodent"]="#cab2d6"
vcol[vcol== "Butterfly"]="#6a3d9a"
vcol[vcol=="Insect seed-feeder parasitoid"]="#ffff99"
vcol[vcol=="Rodent ectoparasite"]="#e7298a"
V(E)$color=vcol
E_edge <- edge_list %>% filter(management == "E") %>% select(node_from,node_to)
E<- graph_from_edgelist(as.matrix(E_edge), directed = FALSE) #create igraph object
S <- vcount(E)#number of species
L <- ecount(E) #number of links
color_trophic <-tibble(taxon = c("Plant","Crop","Flower visitor","Aphid","Primary aphid parasitoid","Secondary aphid parasitoid",
"Leaf-miner parasitoid","Seed-feeding insect","Seed-feeding bird",
"Seed-feeding rodent","Butterfly","Insect seed-feeder parasitoid","Rodent ectoparasite"),
color = c("#33a02c","#b15928","#a6cee3","#1f78b4","#b2df8a","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6",
"#6a3d9a", "#ffff99", "#e7298a"))
# assign attributes according to the taxon
V(E)$taxon<-nodes$taxon #create taxon attribute
#create color of taxon as attributes
vcol=V(E)$taxon
vcol[vcol== "Plant"]="#33a02c"
vcol[vcol=="Crop"]="#b15928"
vcol[vcol=="Flower-visiting"]="#a6cee3"
vcol[vcol== "Aphid"]="#1f78b4"
vcol[vcol=="Primary aphid parasitoid"]="#b2df8a"
vcol[vcol=="Secondary aphid parasitoid"]="#fb9a99"
vcol[vcol=="Leaf-miner parasitoid"]="#e31a1c"
vcol[vcol== "Seed-feeding insect"]="#fdbf6f"
vcol[vcol=="Seed-feeding bird"]="#ff7f00"
vcol[vcol=="Seed-feeding rodent"]="#cab2d6"
E_edge <- edge_list %>% filter(management == "E") %>% select(node_from,node_to)
E<- graph_from_edgelist(as.matrix(E_edge), directed = FALSE) #create igraph object
S <- vcount(E)#number of species
L <- ecount(E) #number of links
color_trophic <-tibble(taxon = c("Plant","Crop","Flower visitor","Aphid","Primary aphid parasitoid","Secondary aphid parasitoid",
"Leaf-miner parasitoid","Seed-feeding insect","Seed-feeding bird",
"Seed-feeding rodent","Butterfly","Insect seed-feeder parasitoid","Rodent ectoparasite"),
color = c("#33a02c","#b15928","#a6cee3","#1f78b4","#b2df8a","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6",
"#6a3d9a", "#ffff99", "#e7298a"))
# assign attributes according to the taxon
V(E)$taxon<-nodes$taxon #create taxon attribute
#create color of taxon as attributes
vcol=V(E)$taxon
vcol[vcol== "Plant"]="#33a02c"
vcol[vcol=="Crop"]="#b15928"
vcol[vcol=="Flower visitor"]="#a6cee3"
vcol[vcol== "Aphid"]="#1f78b4"
vcol[vcol=="Primary aphid parasitoid"]="#b2df8a"
vcol[vcol=="Secondary aphid parasitoid"]="#fb9a99"
vcol[vcol=="Leaf-miner parasitoid"]="#e31a1c"
vcol[vcol== "Seed-feeding insect"]="#fdbf6f"
vcol[vcol=="Seed-feeding bird"]="#ff7f00"
vcol[vcol=="Seed-feeding rodent"]="#cab2d6"
vcol[vcol== "Butterfly"]="#6a3d9a"
vcol[vcol=="Insect seed-feeder parasitoid"]="#ffff99"
vcol[vcol=="Rodent ectoparasite"]="#e7298a"
V(E)$color=vcol
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
dev.off()
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
legend_network<-plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("bottom", legend = color_trophic$taxon, pch=21,
col= "black",
pt.bg = color_trophic$color,
pt.cex=2, cex=1, bty="n")
#png("Graphs/E_network.png", width = 800, height = 600)
pdf("Graphs/E_network.pdf", width = 1.5, height = 3)
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
dev.off()
#png("Graphs/E_network.png", width = 800, height = 600)
pdf("Graphs/E_network.pdf", width = 4, height = 5)
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
dev.off()
png("Graphs/Legend_network.png", width = 800, height = 600)
#png("Graphs/Legend_network.png", width = 800, height = 600)
legend_network<-plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("bottom", legend = color_trophic$taxon, pch=21,
col= "black",
pt.bg = color_trophic$color,
pt.cex=2, cex=1, bty="n")
legend_network
legend_network
dev.off()
#png("Graphs/Legend_network.png", width = 800, height = 600)
legend_network<-plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("bottom", legend = color_trophic$taxon, pch=21,
col= "black",
pt.bg = color_trophic$color,
pt.cex=2, cex=1, bty="n")
#png("Graphs/Legend_network.png", width = 800, height = 600)
legend_network<-plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("bottom", legend = color_trophic$taxon, pch = 21,
col = "black",
pt.bg = color_trophic$color,
pt.cex = 2, cex = 1, bty = "n", ncol = 2)
#png("Graphs/Legend_network.png", width = 800, height = 600)
legend_network<-plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("bottom", legend = color_trophic$taxon, pch = 21,
col = "black",
pt.bg = color_trophic$color,
pt.cex = 2, cex = 1, bty = "n", ncol = 2, title = "Trophic guild")
pdf("Graphs/E_network.pdf", width = 4, height = 5)
legend_network<-plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("bottom", legend = color_trophic$taxon, pch = 21,
col = "black",
pt.bg = color_trophic$color,
pt.cex = 2, cex = 1, bty = "n", ncol = 2, title = "Trophic guild")
dev.off()
pdf("Graphs/Legend_network.pdf", width = 4, height = 5)
legend_network<-plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("bottom", legend = color_trophic$taxon, pch = 21,
col = "black",
pt.bg = color_trophic$color,
pt.cex = 2, cex = 1, bty = "n", ncol = 2, title = "Trophic guild")
dev.off()
#png("Graphs/E_network.png", width = 800, height = 600)
pdf("Graphs/E_network.pdf", width = 4, height = 5)
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
dev.off()
###### MODERATE
MCP_edge <- edge_list %>% filter(management == "M") %>% select(node_from,node_to)
#Create igraph object
M_CP<- graph_from_edgelist(as.matrix(MCP_edge), directed = FALSE)
#Identify isolate nodes and remove from the igraph object
isolated_nodes <- which(degree(M_CP) == 0)
M_CP2<- delete_vertices(M_CP, isolated_nodes)
S <- vcount(M_CP2)#number of species
L <- ecount(M_CP2) #number of links
## assign attributes according to the taxon
nodes_in_network<- nodes %>% filter(node_id%in%MCP_edge$node_from | #create the nodelist according to the nodes present in the network
node_id%in%MCP_edge$node_to )
V(M_CP2)$taxon<-nodes_in_network$taxon #create taxon attribute
#create color of taxon as attributes
vcol=V(M_CP2)$taxon
vcol[vcol== "Plant"]="#33a02c"
vcol[vcol=="Crop"]="#b15928"
vcol[vcol=="Flower visitor"]="#a6cee3"
vcol[vcol== "Aphid"]="#1f78b4"
vcol[vcol=="Primary aphid parasitoid"]="#b2df8a"
vcol[vcol=="Secondary aphid parasitoid"]="#fb9a99"
vcol[vcol=="Leaf-miner parasitoid"]="#e31a1c"
vcol[vcol== "Seed-feeding insect"]="#fdbf6f"
vcol[vcol=="Seed-feeding bird"]="#ff7f00"
vcol[vcol=="Seed-feeding rodent"]="#cab2d6"
vcol[vcol== "Butterfly"]="#6a3d9a"
vcol[vcol=="Insect seed-feeder parasitoid"]="#ffff99"
vcol[vcol=="Rodent ectoparasite"]="#e7298a"
V(M_CP2)$color=vcol
#Plot
#png("Graphs/M_CP_network.png", width = 800, height = 600)
pdf("Graphs/M_network.pdf", width = 4, height = 5)
M_CPplot<-plot(M_CP2,edge.arrow.size=.5, vertex.color= V(M_CP2)$color, vertex.size=6, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
#vertex.label.color="black",  #vertex.label.cex=.5, vertex.label.dist=0.5,
edge.curved=0.2)
dev.off()
IMCP_edge <- edge_list %>% filter(management == "IM") %>% select(node_from,node_to)
#Create igraph object
IM_CP<- graph_from_edgelist(as.matrix(IMCP_edge), directed = FALSE)
#Identify isolate nodes and remove from the igraph object
isolated_nodes <- which(degree(IM_CP) == 0)
IM_CP2<- delete_vertices(IM_CP, isolated_nodes)
S <- vcount(IM_CP2)#number of species
L <- ecount(IM_CP2) #number of links
## assign attributes according to the taxon
nodes_in_network<- nodes %>% filter(node_id%in%IMCP_edge$node_from | #create the nodelist according to the nodes present in the network
node_id%in%IMCP_edge$node_to )
V(IM_CP2)$taxon<-nodes_in_network$taxon #create taxon attribute
#create color of taxon as attributes
vcol=V(IM_CP2)$taxon
vcol[vcol== "Plant"]="#33a02c"
vcol[vcol=="Crop"]="#b15928"
vcol[vcol=="Flower visitor"]="#a6cee3"
vcol[vcol== "Aphid"]="#1f78b4"
vcol[vcol=="Primary aphid parasitoid"]="#b2df8a"
vcol[vcol=="Secondary aphid parasitoid"]="#fb9a99"
vcol[vcol=="Leaf-miner parasitoid"]="#e31a1c"
vcol[vcol== "Seed-feeding insect"]="#fdbf6f"
vcol[vcol=="Seed-feeding bird"]="#ff7f00"
vcol[vcol=="Seed-feeding rodent"]="#cab2d6"
vcol[vcol== "Butterfly"]="#6a3d9a"
vcol[vcol=="Insect seed-feeder parasitoid"]="#ffff99"
vcol[vcol=="Rodent ectoparasite"]="#e7298a"
V(IM_CP2)$color=vcol
#Plot
pdf("Graphs/IN_network.pdf", width = 4, height = 5)
IM_CPplot<-plot(IM_CP2,edge.arrow.size=.5, vertex.color= V(IM_CP2)$color, vertex.size=6, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
#vertex.label.color="black",  #vertex.label.cex=.5, vertex.label.dist=0.5,
edge.curved=0.2)
dev.off()
M_CPplot<-plot(M_CP2,edge.arrow.size=.5, vertex.color= V(M_CP2)$color, vertex.size=6, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
#vertex.label.color="black",  #vertex.label.cex=.5, vertex.label.dist=0.5,
edge.curved=0.2, title(main = "Moderate"))
M_CPplot<-plot(M_CP2,edge.arrow.size=.5, vertex.color= V(M_CP2)$color, vertex.size=6, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
#vertex.label.color="black",  #vertex.label.cex=.5, vertex.label.dist=0.5,
edge.curved=0.2, title(main = "Moderate"))
M_CPplot<-plot(M_CP2,edge.arrow.size=.5, vertex.color= V(M_CP2)$color, vertex.size=6, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
#vertex.label.color="black",  #vertex.label.cex=.5, vertex.label.dist=0.5,
edge.curved=0.2, title(main = "Moderate"))
###### MODERATE
MCP_edge <- edge_list %>% filter(management == "M") %>% select(node_from,node_to)
#Create igraph object
M_CP<- graph_from_edgelist(as.matrix(MCP_edge), directed = FALSE)
#Identify isolate nodes and remove from the igraph object
isolated_nodes <- which(degree(M_CP) == 0)
M_CP2<- delete_vertices(M_CP, isolated_nodes)
S <- vcount(M_CP2)#number of species
L <- ecount(M_CP2) #number of links
## assign attributes according to the taxon
nodes_in_network<- nodes %>% filter(node_id%in%MCP_edge$node_from | #create the nodelist according to the nodes present in the network
node_id%in%MCP_edge$node_to )
V(M_CP2)$taxon<-nodes_in_network$taxon #create taxon attribute
#create color of taxon as attributes
vcol=V(M_CP2)$taxon
vcol[vcol== "Plant"]="#33a02c"
vcol[vcol=="Crop"]="#b15928"
vcol[vcol=="Flower visitor"]="#a6cee3"
vcol[vcol== "Aphid"]="#1f78b4"
vcol[vcol=="Primary aphid parasitoid"]="#b2df8a"
vcol[vcol=="Secondary aphid parasitoid"]="#fb9a99"
vcol[vcol=="Leaf-miner parasitoid"]="#e31a1c"
vcol[vcol== "Seed-feeding insect"]="#fdbf6f"
vcol[vcol=="Seed-feeding bird"]="#ff7f00"
vcol[vcol=="Seed-feeding rodent"]="#cab2d6"
vcol[vcol== "Butterfly"]="#6a3d9a"
vcol[vcol=="Insect seed-feeder parasitoid"]="#ffff99"
vcol[vcol=="Rodent ectoparasite"]="#e7298a"
V(M_CP2)$color=vcol
M_CPplot<-plot(M_CP2,edge.arrow.size=.5, vertex.color= V(M_CP2)$color, vertex.size=6, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
#vertex.label.color="black",  #vertex.label.cex=.5, vertex.label.dist=0.5,
edge.curved=0.2, title(main = "Moderate"))
M_CPplot<-plot(M_CP2,edge.arrow.size=.5, vertex.color= V(M_CP2)$color, vertex.size=6, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
#vertex.label.color="black",  #vertex.label.cex=.5, vertex.label.dist=0.5,
edge.curved=0.2)
#png("Graphs/E_network.png", width = 800, height = 600)
pdf("Graphs/E_network.pdf", width = 2, height = 2.5)
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
dev.off()
#png("Graphs/E_network.png", width = 800, height = 600)
pdf("Graphs/E_network.pdf", width = 1, height = 1.5)
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
dev.off()
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
#png("Graphs/E_network.png", width = 800, height = 600)
pdf("Graphs/E_network.pdf", width = 1, height = 1.5)
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
dev.off()
#png("Graphs/E_network.png", width = 800, height = 600)
pdf("Graphs/E_network.pdf", width = 1.5, height = 2)
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
dev.off()
#png("Graphs/E_network.png", width = 800, height = 600)
pdf("Graphs/E_network.pdf", width = 9, height = 5)
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
dev.off()
#png("Graphs/E_network.png", width = 800, height = 600)
pdf("Graphs/E_network.pdf", width = 5, height = 7)
E_network<-plot(E,edge.arrow.size=.5, vertex.color= V(E)$color, vertex.size=4, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
vertex.label.cex=.5, vertex.label.dist=0.5, edge.curved=0.2)
dev.off()
###### MODERATE
MCP_edge <- edge_list %>% filter(management == "M") %>% select(node_from,node_to)
#Create igraph object
M_CP<- graph_from_edgelist(as.matrix(MCP_edge), directed = FALSE)
#Identify isolate nodes and remove from the igraph object
isolated_nodes <- which(degree(M_CP) == 0)
M_CP2<- delete_vertices(M_CP, isolated_nodes)
S <- vcount(M_CP2)#number of species
L <- ecount(M_CP2) #number of links
## assign attributes according to the taxon
nodes_in_network<- nodes %>% filter(node_id%in%MCP_edge$node_from | #create the nodelist according to the nodes present in the network
node_id%in%MCP_edge$node_to )
V(M_CP2)$taxon<-nodes_in_network$taxon #create taxon attribute
#create color of taxon as attributes
vcol=V(M_CP2)$taxon
vcol[vcol== "Plant"]="#33a02c"
vcol[vcol=="Crop"]="#b15928"
vcol[vcol=="Flower visitor"]="#a6cee3"
vcol[vcol== "Aphid"]="#1f78b4"
vcol[vcol=="Primary aphid parasitoid"]="#b2df8a"
vcol[vcol=="Secondary aphid parasitoid"]="#fb9a99"
vcol[vcol=="Leaf-miner parasitoid"]="#e31a1c"
vcol[vcol== "Seed-feeding insect"]="#fdbf6f"
vcol[vcol=="Seed-feeding bird"]="#ff7f00"
vcol[vcol=="Seed-feeding rodent"]="#cab2d6"
vcol[vcol== "Butterfly"]="#6a3d9a"
vcol[vcol=="Insect seed-feeder parasitoid"]="#ffff99"
vcol[vcol=="Rodent ectoparasite"]="#e7298a"
V(M_CP2)$color=vcol
#Plot
#png("Graphs/M_CP_network.png", width = 800, height = 600)
pdf("Graphs/M_network.pdf", width = 5, height = 7)
M_CPplot<-plot(M_CP2,edge.arrow.size=.5, vertex.color= V(M_CP2)$color, vertex.size=6, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
#vertex.label.color="black",  #vertex.label.cex=.5, vertex.label.dist=0.5,
edge.curved=0.2)
dev.off()
IMCP_edge <- edge_list %>% filter(management == "IM") %>% select(node_from,node_to)
#Create igraph object
IM_CP<- graph_from_edgelist(as.matrix(IMCP_edge), directed = FALSE)
#Identify isolate nodes and remove from the igraph object
isolated_nodes <- which(degree(IM_CP) == 0)
IM_CP2<- delete_vertices(IM_CP, isolated_nodes)
S <- vcount(IM_CP2)#number of species
L <- ecount(IM_CP2) #number of links
## assign attributes according to the taxon
nodes_in_network<- nodes %>% filter(node_id%in%IMCP_edge$node_from | #create the nodelist according to the nodes present in the network
node_id%in%IMCP_edge$node_to )
V(IM_CP2)$taxon<-nodes_in_network$taxon #create taxon attribute
#create color of taxon as attributes
vcol=V(IM_CP2)$taxon
vcol[vcol== "Plant"]="#33a02c"
vcol[vcol=="Crop"]="#b15928"
vcol[vcol=="Flower visitor"]="#a6cee3"
vcol[vcol== "Aphid"]="#1f78b4"
vcol[vcol=="Primary aphid parasitoid"]="#b2df8a"
vcol[vcol=="Secondary aphid parasitoid"]="#fb9a99"
vcol[vcol=="Leaf-miner parasitoid"]="#e31a1c"
vcol[vcol== "Seed-feeding insect"]="#fdbf6f"
vcol[vcol=="Seed-feeding bird"]="#ff7f00"
vcol[vcol=="Seed-feeding rodent"]="#cab2d6"
vcol[vcol== "Butterfly"]="#6a3d9a"
vcol[vcol=="Insect seed-feeder parasitoid"]="#ffff99"
vcol[vcol=="Rodent ectoparasite"]="#e7298a"
V(IM_CP2)$color=vcol
#Plot
pdf("Graphs/IN_network.pdf", width = 5, height = 7)
IM_CPplot<-plot(IM_CP2,edge.arrow.size=.5, vertex.color= V(IM_CP2)$color, vertex.size=6, vertex.label=NA,
vertex.frame.color="black", vertex.label.color="black",
#vertex.label.color="black",  #vertex.label.cex=.5, vertex.label.dist=0.5,
edge.curved=0.2)
dev.off()
