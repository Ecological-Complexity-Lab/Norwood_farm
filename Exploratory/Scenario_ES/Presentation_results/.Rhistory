summarize( layer= "Tot",Number = n(), Prop = Number /Total) %>% unique()
taxon_tot_1<-taxon_tot_1[,c(3,1,2,4,5)]
taxon_tot_1<- Final_ES %>% group_by(type) %>% filter(services_to != "None",  hop == 0 |hop == 1) %>%
mutate(Total = n()) %>% group_by(type, taxon) %>%
summarize( layer= "Tot",Number = n(), Prop = Number /Total) %>% unique()
taxon_tot_1<-taxon_tot_1[,c(3,1,2,4,5)]
taxon_ES_1<-rbind(taxon_tot_1,taxon_ES_1)
#Direct
D_taxon_ES_1<-taxon_ES_1 %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
#Indirect
I_taxon_ES_1<-taxon_ES_1 %>% filter(type == "I") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(D_taxon_ES_1 ,
I_taxon_ES_1 ,
ncol = 2)
upper_row<- plot_grid(D_taxon_ES_1 ,
I_taxon_ES_1 ,
ncol = 2)
upper_row
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
taxon_ES<-Final_ES %>% group_by(layer, type) %>% filter(services_to != "None") %>%
mutate(Total = n()) %>% group_by(layer,type, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
taxon_ES<-Final_ES %>% group_by(layer, type) %>% filter(services_to != "None") %>%
mutate(Total = n()) %>% group_by(layer,type, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
taxon_tot<- Final_ES %>% group_by(type) %>% filter(services_to != "None") %>%
mutate(Total = n()) %>% group_by(type, taxon) %>%
summarize( layer= "Tot",Number = n(), Prop = Number /Total) %>% unique()
taxon_tot<-taxon_tot[,c(3,1,2,4,5)]
taxon_ES<-rbind(taxon_tot,taxon_ES)
#Direct
D_taxon_ES<-taxon_ES %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 2 hops")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
#Indirect
I_taxon_ES<-taxon_ES %>% filter(type == "I") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect ES - 2 hops")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
taxon_ES<-Final_ES %>% group_by(layer, type) %>% filter(services_to != "None") %>%
mutate(Total = n()) %>% group_by(layer,type, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
taxon_tot<- Final_ES %>% group_by(type) %>% filter(services_to != "None") %>%
mutate(Total = n()) %>% group_by(type, taxon) %>%
summarize( layer= "Tot",Number = n(), Prop = Number /Total) %>% unique()
taxon_tot<- Final_ES %>% group_by(type) %>% filter(services_to != "None") %>%
mutate(Total = n()) %>% group_by(type, taxon) %>%
summarize( layer= "Tot",Number = n(), Prop = Number /Total) %>% unique()
taxon_tot<-taxon_tot[,c(3,1,2,4,5)]
taxon_ES<-rbind(taxon_tot,taxon_ES)
taxon_ES<-rbind(taxon_tot,taxon_ES)
#Direct
D_taxon_ES<-taxon_ES %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 2 hops")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
#Indirect
I_taxon_ES<-taxon_ES %>% filter(type == "I") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect ES - 2 hops")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(D_taxon_ES ,
I_taxon_ES ,
ncol = 2)
upper_row
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
taxon_ES<-Final_ES %>% group_by(layer, type) %>% filter(services_to != "None") %>%
mutate(Total = n()) %>% group_by(layer,type, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
taxon_tot<- Final_ES %>% group_by(type) %>% filter(services_to != "None") %>%
mutate(Total = n()) %>% group_by(type, taxon) %>%
summarize( layer= "Tot",Number = n(), Prop = Number /Total) %>% unique()
taxon_tot<-taxon_tot[,c(3,1,2,4,5)]
taxon_ES<-rbind(taxon_tot,taxon_ES)
#Direct
D_taxon_ES<-taxon_ES %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 2 hops")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
#Indirect
I_taxon_ES<-taxon_ES %>% filter(type == "I") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect ES - 2 hops")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row
upper_row
upper_row<- plot_grid(D_taxon_ES ,
I_taxon_ES ,
ncol = 2)
upper_row
knitr::opts_chunk$set(echo = FALSE, results = "asis", message=FALSE, warning=FALSE, cache=TRUE, eval = TRUE, dev = c('png'), out.width = '100%', out.height='40%')
## Direct and indirect ES provided in each habitat and aggregated
Final_ES <- read.csv("Final_ES.csv", sep =",")
#1 hop
Hab_ES_prop<-Final_ES %>% group_by(layer, type) %>% filter( hop == 0 | hop == 1,
services_to != "None") %>%
summarize(count= n()) %>% group_by(layer) %>% mutate(tot =sum(count)) %>%
group_by(layer,type) %>% summarize(prop = count/tot)
#1 hop
Hab_ES_prop<-Final_ES %>% group_by(layer, type) %>% filter( hop == 0 | hop == 1,
services_to != "None") %>%
summarize(count= n()) %>% group_by(layer) %>% mutate(tot =sum(count)) %>%
group_by(layer,type) %>% summarize(prop = count/tot)
Hab_ES_1<-Hab_ES_prop%>%
ggplot(aes(y=prop, x=layer, fill =type)) +
geom_bar(position="stack", stat="identity")+ ggtitle("1 hop")+
labs(x='Habitat', y="Prop ES provided") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =13, angle = 90),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11),
legend.position = "bottom")
#2 hops
Hab_ES_prop_2<-Final_ES %>% group_by(layer, type) %>% filter(services_to != "None") %>%
summarize(count= n()) %>% group_by(layer) %>% mutate(tot =sum(count)) %>%
group_by(layer,type) %>% summarize(prop = count/tot)
Hab_ES_2<-Hab_ES_prop_2 %>%
ggplot(aes(y=prop, x=layer, fill =type)) +
geom_bar(position="stack", stat="identity")+ ggtitle("2 hops")+
labs(x='Habitat', y="Prop ES provided") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.text.x= element_text(size =13, angle = 90),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11),
legend.position = "bottom")
upper_row<- plot_grid(Hab_ES_1 ,
Hab_ES_2 ,
ncol = 2)
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
taxon_ES_1<-Final_ES %>% group_by(layer, type) %>% filter(services_to != "None", hop == 0 | hop ==1) %>%
mutate(Total = n()) %>% group_by(layer,type, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
taxon_ES_1<-Final_ES %>% group_by(layer, type) %>% filter(services_to != "None", hop == 0 | hop ==1) %>%
mutate(Total = n()) %>% group_by(layer,type, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
taxon_tot_1<- Final_ES %>% group_by(type) %>% filter(services_to != "None",  hop == 0 |hop == 1) %>%
mutate(Total = n()) %>% group_by(type, taxon) %>%
summarize( layer= "Tot",Number = n(), Prop = Number /Total) %>% unique()
taxon_tot_1<- Final_ES %>% group_by(type) %>% filter(services_to != "None",  hop == 0 |hop == 1) %>%
mutate(Total = n()) %>% group_by(type, taxon) %>%
summarize( layer= "Tot",Number = n(), Prop = Number /Total) %>% unique()
taxon_tot_1<-taxon_tot_1[,c(3,1,2,4,5)]
taxon_tot_1<-taxon_tot_1[,c(3,1,2,4,5)]
taxon_ES_1<-rbind(taxon_tot_1,taxon_ES_1)
taxon_ES_1<-rbind(taxon_tot_1,taxon_ES_1)
#Direct
D_taxon_ES_1<-taxon_ES_1 %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
taxon_ES_1<-rbind(taxon_tot_1,taxon_ES_1)
#Direct
D_taxon_ES_1<-taxon_ES_1 %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
#Indirect
I_taxon_ES_1<-taxon_ES_1 %>% filter(type == "I") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
taxon_ES_1<-rbind(taxon_tot_1,taxon_ES_1)
#Direct
D_taxon_ES_1<-taxon_ES_1 %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
#Indirect
I_taxon_ES_1<-taxon_ES_1 %>% filter(type == "I") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(D_taxon_ES_1 ,
I_taxon_ES_1 ,
ncol = 2)
#Indirect
I_taxon_ES_1<-taxon_ES_1 %>% filter(type == "I") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Indirect ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(D_taxon_ES_1 ,
I_taxon_ES_1 ,
ncol = 2)
upper_row
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
taxon_ES_1<-Final_ES %>% group_by(layer, type) %>% filter(services_to != "None", hop == 0 | hop ==1) %>%
mutate(Total = n()) %>% group_by(layer,type, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
taxon_tot_1<- Final_ES %>% group_by(type) %>% filter(services_to != "None",  hop == 0 |hop == 1) %>%
mutate(Total = n()) %>% group_by(type, taxon) %>%
summarize( layer= "Tot",Number = n(), Prop = Number /Total) %>% unique()
taxon_tot_1<-taxon_tot_1[,c(3,1,2,4,5)]
taxon_ES_1<-rbind(taxon_tot_1,taxon_ES_1)
#Direct
D_taxon_ES_1<-taxon_ES_1 %>% filter(type == "D") %>%
ggplot(aes(y=Prop, x=layer, fill = taxon)) +
geom_bar(position="stack", stat="identity")+ ggtitle("Direct ES - 1 hop")+
labs(x='Habitat', y="Prop ES provided per taxon") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.text.x= element_text(size =11, angle = 90),
axis.text.y= element_text(size =11, angle = 90),
axis.title = element_text(size=15, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_blank(),
legend.text = element_text(size = 5),
legend.position = "bottom",
legend.key.size = unit(0.7,"line"))
upper_row<- plot_grid(D_taxon_ES_1 ,
I_taxon_ES_1 ,
ncol = 2)
upper_row
knitr::opts_chunk$set(echo = FALSE, results = "asis", message=FALSE, warning=FALSE, cache=TRUE, eval = TRUE, dev = c('png'), out.width = '100%', out.height='40%')
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
## Prop of direct and Indirect ES provided per taxon /habitat
Final_ES <- read.csv("Final_ES.csv", sep =",")
taxon_ES_1<-Final_ES %>% group_by(layer, type) %>% filter(services_to != "None", hop == 0 | hop ==1) %>%
mutate(Total = n()) %>% group_by(layer,type, taxon) %>%
summarize( Number = n(), Prop = Number /Total) %>% unique()
taxon_tot_1<-taxon_tot_1[,c(3,1,2,4,5)]
knitr::opts_chunk$set(echo = FALSE, results = "asis", message=FALSE, warning=FALSE, cache=TRUE, eval = TRUE, dev = c('png'), out.width = '100%', out.height='40%')
library(readxl)
knitr::opts_chunk$set(echo = FALSE, results = "asis", message=FALSE, warning=FALSE, cache=TRUE, eval = TRUE, dev = c('png'), out.width = '100%', out.height='40%')
output_ind_ES <- read.csv("Land_use_output_weighted_trial_norem.csv", sep =",")
View(output_ind_ES)
Number<-output_ind_ES %>% group_by(management) %>% n()
library(tidyverse)
library(tidyverse)
library(readr)
library(emln) #multilayer package
library(readr)
library(readxl)
library(ggplot2)
library(cowplot)
library(paletteer)
Number<-output_ind_ES %>% group_by(management) %>% n()
Number<-output_ind_ES %>% group_by(management) %>% count()
View(output_ind_ES)
Number<-output_ind_ES %>% group_by(management) %>% summarize(Number = n())
View(Number)
Number$management <- factor(Number$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
View(Number)
Number<-Number%>%
ggplot(aes(y=Number, x=management)) +
geom_bar(position="stack", stat="identity")+ ggtitle("removal")+
labs(x='Management', y="Prop of outputs (+/-)") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank())
Number
direct_ES <- read.csv("Land_use_dir_weighted_trial_norem.csv", sep =",")
Number<-direct_ES %>% group_by(management) %>% summarize(Number = n())
View(Number)
Number$management <- factor(Number$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
direct_ES_rem <- read.csv("Land_use_dir_weighted_trial_removal.csv", sep =",") #ratio ES
Number_rem<-direct_ES_rem %>% group_by(management) %>% summarize(Number = n())
Number_rem$management <- factor(Number_rem$management, levels = c("E", "SE", "M", "SI","I")) #change order of factors
View(Number_rem)
View(Number)
Number_rem<-Number_rem%>%
ggplot(aes(y=Number, x=management)) +
geom_bar(position="stack", stat="identity")+ ggtitle("removal")+
labs(x='Management', y="Number of indirect effects on E(D)S") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank())
upper_row
